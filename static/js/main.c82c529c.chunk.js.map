{"version":3,"sources":["Model.ts","util/deckGenerator.ts","util/populateVisibleCards.ts","util/shuffle.ts","util/utils.ts","util/takeDevelopmentCard.ts","Splendid/game/moves/PlayerAction.ts","Splendid/game/moves/collectMultipleResources.ts","Splendid/game/moves/collectSingleResource.ts","Splendid/game/moves/purchaseDevelopmentCard.ts","Splendid/game/moves/reserveDevelopmentCard.ts","Splendid/game/moves/index.ts","Splendid/ai.ts","Splendid/board/components.tsx","Splendid/board/GameOver.tsx","Splendid/board/DevelopmentCard.tsx","Splendid/board/CommunityCards.tsx","Splendid/board/GroupedDevelopmentCards.tsx","Splendid/board/Tokens.tsx","Splendid/board/PlayerList.tsx","Splendid/board/UserPlayerInventory.tsx","Splendid/board/Board.tsx","Splendid/game/SplendidGame.ts","Splendid/game/initializeGame.ts","Splendid/GameClient.tsx","Splendid/index.tsx","serviceWorker.ts","index.tsx","App.tsx"],"names":["ResourceType","AllResourceTypes","Object","freeze","keys","filter","x","map","NativeResourceTypes","Wild","blueprints","split","line","length","level","resourceType","cost","prestigePoints","convertBlueprintsToDefinitions","blueprint","placeholders","resourceMap","reduce","idx","replacePlaceholders","source","replacements","replaced","placeholder","replace","RegExp","generateDeck","definitions","isValidDefinition","toDevelopmentCard","definition","isANumber","isResourceType","value","indexOf","input","min","max","parsed","Number","isNaN","id","parseCost","trim","totals","resource","isCard","endsWith","substr","costGroup","cards","tokens","populateVisibleCards","cardRows","forEach","row","visibleCards","stock","pop","shuffle","array","temporaryValue","randomIndex","currentIndex","Math","floor","random","createResourceCollection","bag","color","calculatePayment","required","available","availableCards","availableTokens","requiredCards","requiredTokens","availableWilds","availableCardsOfColor","availableTokensOfColor","requiredCardsOfColor","requiredTokensOfColor","remainingRequiredTokens","naturalTokenCost","wildCost","cardDeficit","hasRequiredResources","missingCards","requiresAdditionalResources","missingResources","target","some","key","add","toMerge","sum","assign","calculatePlayerResourceTotals","playedCards","calculateCardResources","cardResources","card","findCurrentPlayer","state","player","findPlayer","players","currentPlayerId","Error","playerId","find","takeDevelopmentCard","matchesCardId","isStockCard","visibleCardIndex","findIndex","isVisibleCard","reservedCards","push","JSON","stringify","PlayerActionCommand","action","name","this","__proto__","constructor","CollectMultipleResourcesCommand","resources","getAvailableMoves","availableResources","type","actions","y","n","z","move","args","CollectSingleResourceCommand","PurchaseDevelopmentCardCommand","payment","INSUFFICIENT_FUNDS","from","isOnTable","reservedCard","UNAVAILABLE_CARD","deducted","splice","flatMap","accessibleCards","currentPlayer","playerResources","ReserveDevelopmentCardCommand","executeCommand","ctx","CommandType","execute","err","console","error","moves","triggerWin","g","collectMultipleResources","G","collectSingleResource","purchaseDevelopmentCard","reserveDevelopmentCard","objective","multiplier","calculateScore","weight","checker","score","Bot","iterations","_","turn","playoutDepth","objectives","initialState","winGame","POSITIVE_INFINITY","targetState","increasePrestigePoints","MCTSBot","AI","bot","enumerate","cmd","Column","styled","Box","display","flexDirection","Row","Overlay","className","position","top","left","width","height","isActive","zIndex","GameOver","results","onClose","userPlayer","Dialog","open","aria-labelledby","DialogTitle","winner","Typography","variant","DialogContent","dividers","gutterBottom","List","rankings","ListItem","style","fontWeight","ListItemIcon","ListItemText","primary","ListItemSecondaryAction","DialogActions","Button","onClick","DevelopmentCard","onSelected","canSelect","itemProp","data-value","Model","CommunityCards","selectDevelopmentCard","rowIndex","String","Array","fill","i","GroupedDevelopmentCards","groupedCards","clsx","empty","Tokens","selectToken","showEmpty","token","styles","createStyles","flexGrow","fontSize","marginTop","minHeight","reservedCardStack","bgcolor","justifyContent","alignContent","useStyles","makeStyles","PlayerList","classes","PlayerOverview","isCurrentPlayer","withStyles","active","itemScope","itemType","itemID","CurrentPlayerName","writingMode","textOrientation","ReservedCards","marginLeft","maxWidth","padding","overflowY","UserPlayerInventory","onPlayReservedCard","border","alignItems","container","backgroundColor","fontFamily","gridColumnGap","gridRowGap","gridTemplateColumns","gridTemplateRows","gridTemplateAreas","gridArea","board","playerList","inventory","Board","props","gameover","playerID","step","useState","errorMessage","setErrorMessage","selectedTokens","setSelectedTokens","userPlayerId","useMemo","otherPlayers","isUserPlayersTurn","useEffect","isHuman","useCallback","newSelectedTokens","debug","playReservedCard","showWarning","message","window","location","reload","MessageDialog","isOpen","setIsOpen","Snackbar","anchorOrigin","vertical","horizontal","autoHideDuration","BoardLayout","SplendidGame","setup","initial","numPlayers","patrons","totalResources","deck","importDeck","Emerald","Onyx","Ruby","Sapphire","Diamond","moveLimit","onBegin","onEnd","endIf","winners","sort","a","b","GameClient","observer","settings","View","Client","game","ai","numberOfPlayers","multiplayer","process","musicVolume","sfxVolume","displayName","isLocalhost","Boolean","hostname","match","registerValidSW","swUrl","config","navigator","serviceWorker","register","then","registration","onupdatefound","installingWorker","installing","onstatechange","controller","log","onUpdate","onSuccess","catch","ReactDOM","render","Splendid","document","getElementById","URL","href","origin","addEventListener","fetch","response","contentType","headers","get","status","ready","unregister","checkValidServiceWorker"],"mappings":"yJAMYA,E,0HAAAA,K,YAAAA,E,kBAAAA,E,oBAAAA,E,YAAAA,E,kBAAAA,E,aAAAA,M,KAWL,IAAMC,EAAmCC,OAAOC,OACrDD,OAAOE,KAAKJ,GACTK,OAAO,SAAAC,GAAC,MAAiB,kBAANA,IACnBC,IAAI,SAAAD,GAAC,OAAIN,EAAaM,MAGdE,EAAsBN,OAAOC,OACxCD,OAAOE,KAAKJ,GAAcK,OAAO,SAAAC,GAAC,OAAIA,IAAMN,EAAaS,QCbrDC,EAAa,kwBAoBhBC,MAAM,MACNN,OAAO,SAAAO,GAAI,OAAIA,GAAQA,EAAKC,SAC5BN,IAAI,SAAAK,GAAI,OAAIA,EAAKD,MAAM,OACvBJ,IACC,yCACG,CACCO,MAFJ,KAGIC,aAHJ,KAIIC,KAJJ,KAKIC,eALJ,QA6BEC,EAAiC,SACrCC,EACAC,GAIA,IAAMC,EAAcD,EAAaE,OAAO,SAACf,EAAKD,EAAGiB,GAE/C,OADAhB,EAAID,GAAKE,EAAoBe,GACtBhB,GACN,IAEH,OAAOY,EAAUZ,IACf,gBAAGS,EAAH,EAAGA,KAAMF,EAAT,EAASA,MAAOG,EAAhB,EAAgBA,eAAgBF,EAAhC,EAAgCA,aAAhC,MACG,CACCC,KAAMQ,EAAoBR,EAAMI,EAAcC,GAC9CP,MAAOA,EACPG,eAAgBA,EAChBF,aAAcM,EAAYN,OAK5BS,EAAsB,SAACC,EAAQL,EAAcM,GAAvB,OAC1BN,EAAaE,OACX,SAACK,EAAUC,GAAX,OACED,EAASE,QACP,IAAIC,OAAJ,WAAeF,EAAf,KAA+B,KAC/BF,EAAaE,KAEjBH,IAGSM,EAAe,SAACC,GAAD,OAC1BA,EAAY3B,OAAO4B,GAAmB1B,IAAI2B,IAEtCD,EAAoB,SAACE,GAAD,OACxBA,KACEA,EAAWnB,MACboB,EAAUD,EAAWrB,MAAO,EAAG,IAC/BuB,EAAeF,EAAWpB,eAC1BqB,EAAUD,EAAWlB,eAAgB,EAAG,KAEpCoB,EAAiB,SAAAC,GAAK,OAAIpC,OAAOE,KAAKJ,GAAcuC,QAAQD,IAAU,GAEtEF,EAAY,SAACI,EAAeC,EAAaC,GAA7B,OACdC,EACAC,OAAOJ,IADaI,OAAOC,MAAMF,IAAWA,GAAUF,GAAOE,GAAUD,EAAxE,IAACC,GAIET,EAAoB,SAAC,EAEzBY,GAFwB,IACtB9B,EADsB,EACtBA,KAAMF,EADgB,EAChBA,MAAOG,EADS,EACTA,eAAgBF,EADP,EACOA,aADP,MAGH,CACrB+B,GAAG,GAAD,OAAKA,EAAL,aAAYhC,EAAZ,YAAqBC,GACvBD,MAAO8B,OAAO9B,GACdC,aAAcf,EAAae,GAC3BC,KAAM+B,EAAU/B,GAChBC,eAAgB2B,OAAO3B,KAGnB8B,EAAY,SAAC/B,GAAD,OACfA,GAAQ,IACNL,MAAM,KACNJ,IAAI,SAAAD,GAAC,OAAIA,EAAE0C,SACX1B,OACC,SAAC2B,EAAQC,GACP,IAAMC,EAASD,EAASE,SAAS,QAE3BrC,EAAeoC,EACjBD,EAASG,OAAO,EAAGH,EAASrC,OAAS,OAAOA,QAC5CqC,EAEEI,EAAYL,EAAOE,EAAS,QAAU,UAG5C,OAFAG,EAAUvC,IAAiBuC,EAAUvC,IAAiB,GAAK,EAEpDkC,GAET,CAAEM,MAAO,GAAIC,OAAQ,MC3IdC,EAAuB,SAACC,GACnCA,EAASC,QAAQ,SAAAC,GACf,IAAK,IAAItD,EAAI,EAAGA,EAAIsD,EAAIC,aAAahD,OAAQP,IAChB,MAAvBsD,EAAIC,aAAavD,IAAmC,IAArBsD,EAAIE,MAAMjD,SAC3C+C,EAAIC,aAAavD,GAAKsD,EAAIE,MAAMC,UCA3BC,EAAU,SAASC,GAK9B,IAJA,IACIC,EAAgBC,EADhBC,EAAeH,EAAMpD,OAIlB,IAAMuD,GAEXD,EAAcE,KAAKC,MAAMD,KAAKE,SAAWH,GAIzCF,EAAiBD,EAHjBG,GAAgB,GAIhBH,EAAMG,GAAgBH,EAAME,GAC5BF,EAAME,GAAeD,EAGvB,OAAOD,G,QCqBIO,EAA2B,kBACtCtE,OAAOE,KAAKJ,GAAcsB,OAExB,SAACmD,EAAKC,GAAN,OAAkBD,EAAIC,GAAS,EAAID,GACnC,KAYSE,EAAmB,SAC9BC,EACAC,GAEA,IAAMC,EAAkBD,GAAaA,EAAUtB,OAAU,GACnDwB,EAAmBF,GAAaA,EAAUrB,QAAW,GACrDwB,EAAiBJ,GAAYA,EAASrB,OAAU,GAChD0B,EAAkBL,GAAYA,EAASpB,QAAW,GAGpD0B,EAAiBH,EAAgB/E,EAAaS,OAAS,EAEvDO,EAAO,CACTuC,MAAOiB,IACPhB,OAAQgB,KAXS,uBAcnB,YAAkBhE,EAAlB,+CAAuC,CAAC,IAA/BkE,EAA8B,QAC/BS,EAAwBL,EAAeJ,IAAU,EACjDU,EAAyBL,EAAgBL,IAAU,EACnDW,EAAuBL,EAAcN,IAAU,EAC/CY,EAAwBL,EAAeP,IAAU,EAGvD,GAAIW,EAAuBC,IAA0B,EAArD,CAYA,IAAIC,EAA0BD,EAQ9BC,GAJqBlB,KAAK5B,IACxB8C,EACAJ,GAMF,IAAMK,EAAmBnB,KAAK5B,IAC5B8C,EACAH,GAEFG,GAA2BC,EAG3B,IAAMC,EAAWpB,KAAK5B,IAAI8C,EAAyBL,IACnDK,GAA2BE,GAIG,EAC5BzE,EAAKwC,OAAOkB,IAAUa,GAGtBvE,EAAKwC,OAAOkB,IAAU1D,EAAKwC,OAAOkB,IAAU,GAAKc,EACjDxE,EAAKwC,OAAOxD,EAAaS,OACtBO,EAAKwC,OAAOxD,EAAaS,OAAS,GAAKgF,EAI1CP,GAAkBO,GAIpB,IAAMC,EAAcrB,KAAK3B,IACvB,EACA2C,EAAuBF,GAEzBnE,EAAKuC,MAAMmB,IAAU1D,EAAKuC,MAAMmB,IAAU,GAAKgB,IA3E9B,kFA8EnB,OAAO1E,GAGI2E,EAAuB,SAClCf,EACAC,GAEA,IAAM7D,EAAO6D,EAAYF,EAAiBC,EAAUC,GAAaD,EAC3DgB,EAAeC,EAA4B7E,EAAKuC,OAChDuC,EAAmBD,EAA4B7E,EAAKwC,QAC1D,QAASoC,GAAgBE,IAGrBD,EAA8B,SAACE,GAAD,OACxB,MAAVA,GAAyB7F,OAAOE,KAAK2F,GAAQC,KAAK,SAAAC,GAAG,OAAIF,EAAOE,GAAO,KAE5DC,EAAM,SACjBH,EACAI,GAFiB,OAIjBjG,OAAOE,KAAK+F,GAAS7E,OACnB,SAAC8E,EAAKrF,GAOJ,OANyB,MAArBqF,EAAIrF,GACNqF,EAAIrF,GAAgBqF,EAAIrF,GAAgBoF,EAAQpF,GAEhDqF,EAAIrF,GAAgBoF,EAAQpF,GAGvBqF,GAGTlG,OAAOmG,OAAO,GAAIN,GAAU,MAyCnBO,EAAgC,SAAC,GAAD,IAC3CC,EAD2C,EAC3CA,YAD2C,MAG9B,CACb/C,OAJ2C,EAE3CA,OAGAD,MAAOiD,EAAuBD,KAGnBC,EAAyB,SAACjD,GAAD,OACpCA,EAAMjC,OACJ,SAACmF,EAAeC,GAGd,OAFAD,EAAcC,EAAK3F,eAChB0F,EAAcC,EAAK3F,eAAiB,GAAK,EACrC0F,GAET,KAuBSE,EAAoB,SAACC,GAChC,IAAMC,EAASC,EAAWF,EAAMG,QAASH,EAAMI,iBAC/C,GAAc,MAAVH,EACF,MAAM,IAAII,MAAM,gCAElB,OAAOJ,GAGIC,EAAa,SACxBC,EACAG,GAFwB,OAIb,MAAXH,EAAkB,KAAOA,EAAQI,KAAK,SAAA7G,GAAC,OAAIA,EAAEwC,KAAOoE,KCnQzCE,EAAsB,SACjCR,EACAF,GAEA,IAAMG,EAASF,EAAkBC,GAD9B,uBAGH,YAAgBA,EAAM9B,eAAtB,+CAAsC,CAAC,IAA9BlB,EAA6B,QAC9ByD,EAAgB,SAAC/G,GAAD,OAAwBA,GAAKA,EAAEwC,KAAO4D,EAAK5D,IAG3DwE,EAAcD,EADCzD,EAAIE,MAAMF,EAAIE,MAAMjD,OAAS,IAG5C0G,EAAmB3D,EAAIC,aAAa2D,UAAUH,GAC9CI,EAAgBF,GAAoB,EAE1C,GAAID,EAGF,OAFA1D,EAAIE,MAAMC,WACV8C,EAAOa,cAAcC,KAAKjB,GAErB,GAAIe,EAGT,OAFA7D,EAAIC,aAAa0D,GAAoB,UACrCV,EAAOa,cAAcC,KAAKjB,IAlB3B,kFAuBH,MAAM,IAAIO,MAAJ,6BACkBW,KAAKC,UACzBnB,GAFE,kD,QChBcoB,EAAtB,WAQE,WAA4BC,GAAY,yBAAZA,SAR9B,mDAEI,OAAOH,KAAKC,UAAU,CACpBG,KAAOC,KAAaC,UAAUC,YAAYH,KAC1CD,OAAQE,KAAKF,aAJnB,KCDaK,EAAb,gLAGUxB,GAAmB,IAAD,uBACxB,YAAqBqB,KAAKF,OAAOM,UAAjC,+CAA4C,CAAC,IAApCnF,EAAmC,QAC1C0D,EAAM7B,gBAAgB7B,IACnB0D,EAAM7B,gBAAgB7B,IAAa,GAAK,EAE3CyD,EAAkBC,GAAOpD,OAAON,IAC7ByD,EAAkBC,GAAOpD,OAAON,IAAa,GAAK,GAN/B,kFASxB,OAAO0D,MAZX,GAAqDkB,GAAxCM,EAeKE,kBAAoB,SAAC1B,GACnC,IAAM2B,EAAqB/H,EAAoBH,OAC7C,SAAAmI,GAAI,OAAI5B,EAAM7B,gBAAgByD,GAAQ,IACtCjI,IAAI,SAAAD,GAAC,OAAIN,EAAaM,KAGxB,GAAIiI,EAAmB1H,OAAS,EAAG,MAAO,GAG1C,IAAI4H,EAAwD,GATa,uBAWzE,IAXyE,IAWzE,EAXyE,iBAWhEnI,EAXgE,+BAYvE,IAZuE,IAYvE,EAZuE,iBAY9DoI,EAZ8D,+BAarE,YAAcH,EAAmBlI,OAAO,SAAAsI,GAAC,OAAIA,IAAMrI,GAAKqI,IAAMD,IAA9D,+CAAkE,CAAC,IAA1DE,EAAyD,QAChEH,EAAQd,KAAK,CAACrH,EAAGoI,EAAGE,KAd+C,oFAYvE,EAAcL,EAAmBlI,OAAO,SAAAsI,GAAC,OAAIA,IAAMrI,IAAnD,+CAAwD,IAZe,oFAWzE,EAAciI,EAAd,+CAAmC,IAXsC,kFAmBzE,OAAOE,EAAQlI,IAAI,SAAA8H,GAAS,MAAK,CAC/BQ,KAAM,2BACNC,KAAM,CAACT,OCpCN,IAAMU,EAAb,gLAGUnC,GACNA,EAAM7B,gBAAgBkD,KAAKF,OAAO7E,WAC/B0D,EAAM7B,gBAAgBkD,KAAKF,OAAO7E,WAAa,GAAK,EAEvD,IAAM2D,EAASF,EAAkBC,GAKjC,OAHAC,EAAOrD,OAAOyE,KAAKF,OAAO7E,WACvB2D,EAAOrD,OAAOyE,KAAKF,OAAO7E,WAAa,GAAK,EAExC0D,MAZX,GAAkDkB,GAArCiB,EAeKT,kBAAoB,SAAC1B,GAAD,OAClCpG,EAAoBH,OAAO,SAAAmI,GAAI,OAAI5B,EAAM7B,gBAAgByD,IAAS,IAC/DjI,IAAI,SAAAD,GAAC,OAAIN,EAAaM,KACtBC,IAAI,SAAA2C,GAAQ,MAAK,CAAE2F,KAAM,wBAAyBC,KAAM,CAAC5F,OCTzD,IAAM8F,EAAb,gLAQUpC,GACN,IAAMF,EAAOuB,KAAKF,OAAOrB,KAEzB,GAAY,MAARA,EACF,MAAM,IAAIO,MAAM,iCAGlB,IAAMJ,EAASF,EAAkBC,GAE3BqC,EAAUtE,EACd+B,EAAK1F,KACLsF,EAA8BO,IAGhC,IAAKlB,EAAqBsD,GACxB,MAAM,IAAIhC,MAAM+B,EAA+BE,oBAGjD,ILlCFlI,EACAmI,EKiCQC,EAAYxC,EAAM9B,eAAekB,KAAK,SAAApC,GAAG,OAC7CA,EAAIC,aAAamC,KAAK,SAAA1F,GAAC,OAAIA,GAAKA,EAAEwC,KAAO4D,EAAK5D,OAG5CuG,EAAexC,EAAOa,cAAcP,KAAK,SAAA7G,GAAC,OAAIA,EAAEwC,KAAO4D,EAAK5D,KAEhE,IAAKuG,IAAiBD,EACpB,MAAM,IAAInC,MAAM+B,EAA+BM,kBAuBjD,OAnBAzC,EAAOrD,QL7CTxC,EK6CyBiI,EAAQzF,OL5CjC2F,EK4CyCtC,EAAOrD,OL1ChDtD,OAAOE,KAAKY,GAAMM,OAChB,SAACiI,EAAUxI,GAOT,OAN8B,MAA1BwI,EAASxI,GACXwI,EAASxI,GAAgBwI,EAASxI,GAAgBC,EAAKD,GAEvDwI,EAASxI,IAAiBC,EAAKD,GAG1BwI,GAGTrJ,OAAOmG,OAAO,GAAI8C,GAAQ,MKkC1BvC,EAAM7B,gBAAkBmB,EAAIU,EAAM7B,gBAAiBkE,EAAQzF,QAGvD4F,IACFhC,EAAoBR,EAAOF,GAC3B2C,EAAe3C,GAIjBG,EAAOa,cAAc8B,OAAO3C,EAAOa,cAAcnF,QAAQ8G,GAAe,GAGxExC,EAAON,YAAYoB,KAAKjB,GAExBG,EAAO5F,gBAAkB4F,EAAO5F,gBAAkB,GAAKyF,EAAKzF,eAErD2F,MAxDX,GAAoDkB,GAAvCkB,EAGKE,mBACd,sDAJSF,EAMKM,iBAAmB,gCANxBN,EA2DKV,kBAAoB,SAAC1B,GACnC,IAAM/C,EAAe+C,EAAM9B,eAAe2E,QAAQ,SAAAnJ,GAAC,OAAIA,EAAEuD,eACjD6D,EAAkBf,EAAkBC,GAApCc,cACFgC,EAAkB,sBAAI7F,GAAJ,YAAqB6D,IAAerH,OAC1D,SAAAC,GAAC,OAAS,MAALA,IAGDqJ,EAAgBhD,EAAkBC,GAElCgD,EAAkC,CACtCpG,OAAQmG,EAAcnG,OACtBD,MAAOiD,EAAuBmD,EAAcpD,cAO9C,OAJsBmD,EAAgBrJ,OAAO,SAAAqG,GAAI,OAC/Cf,EAAqBe,EAAK1F,KAAM4I,KAGbrJ,IAAI,SAAAmG,GAAI,MAAK,CAChCmC,KAAM,0BACNC,KAAM,CAACpC,OCxFN,IAAMmD,EAAb,gLAGUjD,GACN,IAAMF,EAAOuB,KAAKF,OAAOrB,KAEzB,GAAY,MAARA,EACF,MAAM,IAAIO,MAAM,gCAGlB,IAAMJ,EAASF,EAAkBC,GAWjC,OARIA,EAAM7B,gBAAgBtE,KAAO,IAC/BoG,EAAOrD,OAAO/C,MAAQoG,EAAOrD,OAAO/C,MAAQ,GAAK,EACjDmG,EAAM7B,gBAAgBtE,MAAQmG,EAAM7B,gBAAgBtE,MAAQ,GAAK,GAInE2G,EAAoBR,EAAOF,GAEpBE,MArBX,GAAmDkB,GAAtC+B,EAwBKvB,kBAAoB,SAAC1B,GAGnC,OAFeD,EAAkBC,GAEtBc,cAAc7G,QAAU,EAC1B,GAGF+F,EAAM9B,eACV2E,QAAQ,SAAAnJ,GAAC,OAAIA,EAAEuD,eACfxD,OAAO,SAAAC,GAAC,OAAS,MAALA,IACZC,IAAI,SAAAmG,GAAI,MAAK,CAAEmC,KAAM,yBAA0BC,KAAM,CAACpC,OClCtD,IAQDoD,EAAiB,SACrBlD,EACAmD,EACAC,EACAlB,GAEA,IAEE,OADY,IAAIkB,EAAYlB,GACjBmB,QAAQrD,GACnB,MAAOsD,GAEP,OADAC,QAAQC,MAAMF,GACPtD,IAyBIyD,EArB4C,CACzDC,WAAY,SAAAC,GAGV,OAFe5D,EAAkB4D,GAC1BtJ,eAAiB,GACjBsJ,GAETC,yBAA0B,SAACC,EAAGV,EAAK1B,GAAT,OACxByB,EAAeW,EAAGV,EAAK3B,EAAiC,CACtDC,eAGJqC,sBAAuB,SAACD,EAAGV,EAAK7G,GAAT,OACrB4G,EAAeW,EAAGV,EAAKhB,EAA8B,CAAE7F,cAEzDyH,wBAAyB,SAACF,EAAGV,EAAKrD,GAAT,OACvBoD,EAAeW,EAAGV,EAAKf,EAAgC,CAAEtC,UAE3DkE,uBAAwB,SAACH,EAAGV,EAAKrD,GAAT,OACtBoD,EAAeW,EAAGV,EAAKF,EAA+B,CAAEnD,W,4NC/C5D,IAAMmE,EAAY,SAChBC,EACAC,GAFgB,MAGZ,CACJC,OAAQ,EACRC,QAAS,SAASrE,GAChB,IAAMsE,EAAQH,EAAenE,GAE7B,OADAqB,KAAK+C,OAASE,EAAQJ,EACf7C,KAAK+C,OAAS,KAInBG,E,YACJ,WAAYrC,GAAO,qE,qVAAA,IAEZA,EAFW,CAGdsC,WAAY,SAACC,EAAGtB,GAAJ,OAAsB,IAAiB,EAAXA,EAAIuB,MAC5CC,aAAc,SAACF,EAAGtB,GAAJ,OAAsB,IACpCyB,WAAY,SACVC,EACAJ,EACAnE,GAEA,IAAKA,EAAU,MAAO,GAEtB,IAAML,EAASC,EAAW2E,EAAa1E,QAASG,GAEhD,MAAO,CACLwE,QAASb,EACPjI,OAAO+I,kBACP,SAACC,GAAD,OACE9E,EAAW8E,EAAY7E,QAASG,GAAUjG,gBAAkB,GACxD,EACA,IAER4K,uBAAwBhB,EACtB,GACA,SAACe,GAAD,OACE9E,EAAW8E,EAAY7E,QAASG,GAAUjG,eAC1C4F,EAAO5F,uB,2BA3BH6K,KAmCHC,cAAG,CAChBC,IAAKb,EACLc,UD3C+B,SAACrF,GAAD,MAC/B,CACEwB,EACAW,EACAC,EACAa,GACAJ,QAAQ,SAAAyC,GAAG,OAAIA,EAAI5D,kBAAkB1B,Q,0DEd5BuF,GAASC,aAAOC,KAAPD,CAAY,CAAEE,QAAS,OAAQC,cAAe,WAEvDC,GAAMJ,aAAOC,KAAPD,CAAY,CAAEE,QAAS,OAAQC,cAAe,QAMpDE,GAAUL,aAAO,gBAAGM,EAAH,EAAGA,UAAH,OAC5B,yBAAKA,UAAWA,KADKN,CAEpB,CACDO,SAAU,WACVC,IAAK,EACLC,KAAM,EACNC,MAAO,QACPC,OAAQ,gBAAGC,EAAH,EAAGA,SAAH,gBAAqBA,EAAW,IAAM,EAAtC,OACRC,OAAQ,M,6GCEGC,GAAW,SAAC,GAAD,IAAGC,EAAH,EAAGA,QAASC,EAAZ,EAAYA,QAASC,EAArB,EAAqBA,WAArB,OACtB,kBAACC,GAAA,EAAD,CAAQC,MAAI,EAACH,QAASA,EAASI,kBAAgB,2BAC7C,kBAACC,GAAA,EAAD,KACGN,EAAQO,SAAWL,EAClB,kBAACM,GAAA,EAAD,CAAYC,QAAQ,MAApB,YAEA,kBAACD,GAAA,EAAD,CAAYC,QAAQ,MAApB,cAGJ,kBAACC,GAAA,EAAD,CAAeC,UAAQ,GACrB,kBAACH,GAAA,EAAD,CAAYI,cAAY,EAACH,QAAQ,MAAjC,mBAGA,kBAACI,GAAA,EAAD,KACGb,EAAQc,SAAS1N,IAAI,SAACsG,EAAQtF,GAAT,OACpB,kBAAC2M,GAAA,EAAD,CACEjI,IAAKY,EAAO/D,GACZqL,MAAO,CACLC,WAAY,IACZ1J,MAAOmC,IAAWwG,EAAa,OAAS,KAG1C,kBAACgB,GAAA,EAAD,KACE,8BAAO9M,EAAM,IAEf,kBAAC+M,GAAA,EAAD,CAAcC,QAAS1H,EAAOmB,OAC9B,kBAACwG,GAAA,EAAD,KACG3H,EAAO5F,qBAMlB,kBAACwN,GAAA,EAAD,KACE,kBAACC,GAAA,EAAD,CAAQC,QAASvB,EAAS1I,MAAM,WAAhC,eCrDOkK,GAAkB,SAAC,GAAD,IAC7BlI,EAD6B,EAC7BA,KACAmI,EAF6B,EAE7BA,WACAC,EAH6B,EAG7BA,UAH6B,OAS7B,yBACEpC,UAAS,eAAUhG,EAAK5D,IAAMgM,EAAY,eAAiB,GAAlD,YACPpI,EAAK3F,cAEPgO,SAAS,OACTJ,QAAS,oBAAOjI,EAAK5D,KAAMgM,IAAYD,EAAWnI,KAElD,yBAAKqI,SAAS,WAAWC,aAAYtI,EAAK3F,eACzC2F,GAAQA,EAAKzF,eAAiB,GAC7B,yBAAK8N,SAAS,iBAAiBC,aAAYtI,EAAKzF,iBAElD,yBAAK8N,SAAS,QACXrI,GACCA,EAAK1F,MACLiO,EAAuB5O,OACrB,SAAA6C,GAAQ,OAAIwD,EAAK1F,KAAKwC,OAAON,GAAY,IACzC3C,IAAI,SAAA2C,GAAQ,OACZ,yBAAK+C,IAAK/C,EAAU6L,SAAS,SAC3B,yBAAKA,SAAS,WAAWC,aAAY9L,IACrC,yBAAK6L,SAAS,QAAQC,aAAYtI,EAAK1F,KAAKwC,OAAON,WC3BlDgM,GAAiB,SAAC,GAAD,IAAGpK,EAAH,EAAGA,eAAgBqK,EAAnB,EAAmBA,sBAAnB,OAC5B,oCACGrK,EAAevE,IAAI,SAACqD,EAAKwL,GAAN,OAClB,yBAAKnJ,IAAKoJ,OAAOD,GAAW1C,UAAU,WACpC,yBACEA,UAAU,0BACViC,QAAS,mBACP/K,EAAIE,MAAMjD,QACNsO,EAAsBvL,EAAIE,MAAMF,EAAIE,MAAMjD,OAAS,MAIzD,8BAAO+C,EAAIE,MAAMjD,SAElByO,MAAM,GACJC,KAAK,GACLhP,IACC,SAAC8K,EAAGmE,GAAJ,OACE5L,EAAIC,aAAa2L,IAAO,CAAE1M,GAAI,QAEjCvC,IAAI,SAACmG,EAAMnF,GAAP,OACH,kBAAC,GAAD,CACE0E,IAAKS,EAAK5D,IAAL,UAAcc,EAAI9C,OAAlB,OAA0BS,GAC/BmF,KAAMA,EACNmI,WAAYM,W,QCnBbM,GAA0B,SAAC,GAEJ,IADlClM,EACiC,EADjCA,MAEMmM,EAAeT,EAA0B1O,IAAI,SAAAQ,GAAY,MAAK,CAClEA,eACAwC,MAAOA,EAAMlD,OAAO,SAAAC,GAAC,OAAIA,EAAES,eAAiBA,OAG9C,OACE,oCACG2O,EAAanP,IAAI,gBAAGQ,EAAH,EAAGA,aAAcwC,EAAjB,EAAiBA,MAAjB,OAChB,kBAAC4I,GAAD,CACElG,IAAKlF,EACL2L,UAAWiD,aAAK,YAAa5O,EAAc,CACzC6O,OAAQrM,GAA0B,IAAjBA,EAAM1C,UAGxB0C,EAAM1C,YChBJgP,GAAS,SAAC,GAAD,IACpBrM,EADoB,EACpBA,OACAsM,EAFoB,EAEpBA,YAFoB,IAGpBC,iBAHoB,gBAKpB,oCACG9P,EAAiBM,IAChB,SAAAyP,GAAK,OACFxM,EAAOwM,IAAUD,IAChB,yBACE9J,IAAK+J,EACLjB,SAAS,QACTrC,UAAWiD,aAAK,CAAEC,MAAgC,KAAxBpM,EAAOwM,IAAU,KAC3CrB,QAAS,kBAAMmB,GAAeA,EAAYE,KAE1C,yBAAKjB,SAAS,WAAWC,aAAYgB,IACrC,yBAAKjB,SAAS,QAAQC,aAAYxL,EAAOwM,IAAU,S,UCjBzDC,GAASC,aAAa,CAC1BlI,KAAM,CAAEmI,SAAU,GAClBtJ,OAAQ,GACRrD,OAAQ,CAAE4M,SAAU,SAAUhC,WAAY,QAC1C7K,MAAO,CAAE8M,UAAW,QAASD,SAAU,SAAUE,UAAW,QAC5DC,kBAAmB,CACjBC,QAAS,OACT7D,SAAU,WACVyB,WAAY,IACZqC,eAAgB,SAChBC,aAAc,YAIZC,GAAYC,aAAWX,IAEhBY,GAAa,SAAC,GAAgC,IAA9B9J,EAA6B,EAA7BA,QAAS4C,EAAoB,EAApBA,cAC9BmH,EAAUH,GAAU,IAC1B,OACE,oCACG5J,EAAQxG,IAAI,SAACsG,GAAD,OACX,kBAACkK,GAAD,CACE9K,IAAKY,EAAO/D,GACZgO,QAASA,EACTE,gBAAiBnK,IAAW8C,EAC5B9C,OAAQA,QAYZkK,GAAiBE,aAAWhB,GAAXgB,CACrB,gBAAGH,EAAH,EAAGA,QAASE,EAAZ,EAAYA,gBAAiBnK,EAA7B,EAA6BA,OAA7B,OACE,kBAACsF,GAAD,CACEO,UAAWiD,aAAKmB,EAAQjK,OAAQ,SAAU,CAAEqK,OAAQF,IACpDG,WAAS,EACTC,SAAS,eACTC,OAAQhC,OAAOxI,EAAO/D,KAEtB,kBAAC0J,GAAD,KACE,kBAACH,GAAA,EAAD,CAAKK,UAAWoE,EAAQ9I,KAAM+G,SAAS,QACpClI,EAAOmB,MAEV,kBAACqE,GAAA,EAAD,CAAK+B,WAAY,KAAMvH,EAAO5F,iBAEhC,kBAACuL,GAAD,CAAKE,UAAWoE,EAAQtN,QACtB,kBAAC,GAAD,CAAQA,OAAQqD,EAAOrD,UAEzB,kBAACgJ,GAAD,CAAKE,UAAWoE,EAAQvN,OACtB,kBAAC4I,GAAD,CAAQO,UAAWiD,aAAK,YAAamB,EAAQP,oBACzC1J,EAAOa,eAAiBb,EAAOa,cAAc7G,QAAW,GAE5D,kBAAC,GAAD,CAAyB0C,MAAOsD,EAAON,kBCzDzC+K,GAAoBlF,aAAO,KAAPA,CAAa,CACrCmF,YAAa,cACbC,gBAAiB,YAGbC,GAAgBrF,aAAOI,GAAPJ,CAAY,CAChC+D,SAAU,EACV,4BAA6B,CAC3BuB,WAAY,SAEdC,SAAU,OACVC,QAAS,WACTC,UAAW,SAGAC,GAAsB,SAAC,GAAD,IACjCd,EADiC,EACjCA,gBACAnK,EAFiC,EAEjCA,OACAkL,EAHiC,EAGjCA,mBAHiC,OASjC,kBAACvF,GAAD,CACEG,SAAS,WACTwD,SAAU,EACVzD,UAAWiD,aAAK,cAAe,CAAEuB,OAAQF,KAEzC,kBAACM,GAAD,KAAoBzK,EAAOmB,MAC3B,kBAACqE,GAAA,EAAD,CACEK,UAAU,iBACVI,MAAM,OACNsD,SAAS,OACThC,WAAW,OAEVvH,EAAO5F,gBAEV,kBAACuL,GAAD,CAAK2D,SAAU,GACb,kBAAC3D,GAAD,CAAKwF,OAAO,kBACV,kBAAC7F,GAAD,CACEiE,SAAS,uBACT6B,WAAW,SACXnF,MAAM,OACN8E,QAAQ,UAER,kBAAC,GAAD,CAAQpO,OAAQqD,EAAOrD,UAEzB,kBAACiO,GAAD,KACG5K,EAAOa,cAAcnH,IAAI,SAAAmG,GAAI,OAC5B,kBAAC,GAAD,CACET,IAAKS,EAAK5D,GACV4D,KAAMA,EACNmI,WAAYkD,QAKpB,kBAACvF,GAAD,CAAK4D,SAAS,OACZ,kBAAC,GAAD,CAAyB7M,MAAOsD,EAAON,kBClDzCoK,GAAYC,aAAW,kBAC3BV,aAAa,CACXgC,UAAW,CACTxN,MAAO,OACPyN,gBAAiB,OACjBC,WAAY,kDACZhC,SAAU,iBACVrD,OAAQ,QACRT,QAAS,OACT+F,cAAe,SACfC,WAAY,SACZC,oBAAqB,+BACrBC,iBAAkB,yBAClBC,kBAAkB,0FAKpBjP,OAAQ,CACNkP,SAAU,SACVpG,QAAS,OACTC,cAAe,SACf0F,WAAY,SACZxB,eAAgB,eAChBL,SAAU,SAEV,0CAA2C,CACzChC,WAAY,MAIhBuE,MAAO,CACLD,SAAU,QACVpG,QAAS,OACTC,cAAe,SACfkE,eAAgB,gBAGlBmC,WAAY,CACVtG,QAAS,OACTC,cAAe,SACfmE,aAAc,SACdgC,SAAU,cACVP,gBAAiB,OACjBP,QAAS,SAGXiB,UAAW,CACTH,SAAU,YACVpG,QAAS,YAKFwG,GAAQ,SAACC,GAAyD,IAAD,EAOxEA,EALFtI,EAAK3F,EAFqE,EAErEA,eAAgBC,EAFqD,EAErDA,gBAAiBiC,EAFoC,EAEpCA,gBAAiBD,EAFmB,EAEnBA,QAChDiM,EAILD,EAJFhJ,IAAOiJ,SACPC,EAGEF,EAHFE,SACA5I,EAEE0I,EAFF1I,MACA6I,EACEH,EADFG,KAN0E,EASpCC,mBAAS,MAT2B,mBASrEC,EATqE,KASvDC,EATuD,OAUhCF,mBAAS,IAVuB,mBAUrEG,EAVqE,KAUrDC,EAVqD,KAYtEC,EAAeP,GAAYlM,EAAQ,GAAGjE,GAEtC6G,EAAgB8J,kBAAQ,kBAAM3M,EAAWC,EAASC,IAAkB,CACxEA,EACAD,IAGIsG,EAAaoG,kBAAQ,kBAAM3M,EAAWC,EAASyM,IAAe,CAClEzM,EACAyM,IAGIE,EAAeD,kBACnB,kBAAM1M,EAAQ1G,OAAO,SAAAC,GAAC,OAAIA,EAAEwC,KAAO0Q,KACnC,CAACzM,EAASyM,IAGNG,EAAoBH,IAAiBxM,EAE3C4M,oBACE,WACEL,EAAkB,IAEbI,IAAqBhK,GAAkBA,EAAckK,SAExDX,KAIJ,CAACA,EAAMvJ,EAAegK,IAGxB,IAAM7D,EAAcgE,sBAClB,SAAA9D,GACE,GAAIA,IAAUf,EAAmBxO,KAAjC,CAKA,IAAIsT,EAAoBT,EAEpBA,EAAe/Q,QAAQyN,IAAU,EACL,IAA1BsD,EAAezS,QACjBwJ,EAAMK,sBAAsBsF,GAC5B+D,EAAoB,IAEpB5J,QAAQ6J,MAAR,kDAAyDhE,IAG3D+D,EAAiB,sBAAOT,GAAP,CAAuBtD,IAGT,IAA7B+D,EAAkBlT,SACpBwJ,EAAMG,yBAAyBuJ,GAC/BA,EAAoB,IAGtBR,EAAkBQ,QAtBhB5J,QAAQ6J,MAAR,+CAwBJ,CAAC3J,EAAOiJ,IAGJnE,EAAwB2E,sBAC5B,SAACpN,GACC,IAAMkD,EAAkBtD,EAA8BqD,GAElDhE,EAAqBe,EAAK1F,KAAM4I,GAClCS,EAAMM,wBAAwBjE,GAE9B2D,EAAMO,uBAAuBlE,IAGjC,CAACiD,EAAeU,IAGZ4J,EAAmBH,sBACvB,SAACpN,GACC,IAAMkD,EAAkBtD,EAA8BqD,GAElDhE,EAAqBe,EAAK1F,KAAM4I,GAClCS,EAAMM,wBAAwBjE,GAE9BwN,EAAY,gDAGhB,CAACvK,EAAeU,IAGZ6J,EAAc,SAACC,GACnBd,EAAgBc,IAGlB,OACE,oCACGnB,GACC,kBAAC,GAAD,CACE5F,QAAS,kBAAMgH,OAAOC,SAASC,UAC/BnH,QAAS6F,EACT3F,WAAYA,IAGhB,kBAAC,GAAD,CAAe8G,QAASf,IACxB,kBAAC3G,GAAD,CAASO,UAAW2G,IACpB,kBAAC,GAAD,CACE7O,eAAgBA,EAChBC,gBAAiBA,EACjB4E,cAAeA,EACf+J,aAAcA,EACdO,iBAAkBA,EAClB9E,sBAAuBA,EACvBW,YAAaA,EACbzC,WAAYA,MAMdkH,GAAgB,SAAC,GAAiB,IAAfJ,EAAc,EAAdA,QAAc,EACThB,oBAAS,GADA,mBAC9BqB,EAD8B,KACtBC,EADsB,KAKrC,OAFAb,oBAAU,kBAAMa,EAAUN,GAAWA,EAAQtT,OAAS,IAAI,CAACsT,IAGzD,kBAACO,EAAA,EAAD,CACEC,aAAc,CAAEC,SAAU,SAAUC,WAAY,UAChDtH,KAAMiH,EACNpH,QAAS,kBAAMqH,GAAU,IACzBK,iBAAkB,IAClBX,QAASA,KAgBTY,GAAc,SAAC,GASI,IARvBjQ,EAQsB,EARtBA,eACAC,EAOsB,EAPtBA,gBACA4E,EAMsB,EANtBA,cACA+J,EAKsB,EALtBA,aACAO,EAIsB,EAJtBA,iBACA9E,EAGsB,EAHtBA,sBACAW,EAEsB,EAFtBA,YACAzC,EACsB,EADtBA,WAEMyD,EAAUH,GAAU,IAE1B,OACE,yBAAK7N,GAAG,YAAY4J,UAAWoE,EAAQoB,WACrC,yBAAKpP,GAAG,SAAS4J,UAAWoE,EAAQtN,QAClC,kBAAC,GAAD,CAAQA,OAAQuB,EAAiB+K,YAAaA,KAEhD,yBAAKhN,GAAG,QAAQ4J,UAAWoE,EAAQ6B,OACjC,kBAAC,GAAD,CACE7N,eAAgBA,EAChBqK,sBAAuBA,KAG3B,yBAAKrM,GAAG,cAAc4J,UAAWoE,EAAQ8B,YACvC,kBAAC,GAAD,CAAY7L,QAAS2M,EAAc/J,cAAeA,KAEpD,yBAAK7G,GAAG,YAAY4J,UAAWoE,EAAQ+B,WACpCxF,GACC,kBAAC,GAAD,CACE2D,gBAAiB3D,EAAWvK,KAAO6G,EAAc7G,GACjD+D,OAAQwG,EACR0E,mBAAoBkC,OC7PnBe,GAAe,CAC1BC,MCL4B,SAAAC,GAC5B,IAAMnO,EAAoBuI,MAAM4F,EAAQC,YACrC5F,KAAK,GACLhP,IACC,SAAC8K,EAAGvI,GAAJ,MACG,CACCA,GAAIuM,OAAOvM,GACXkF,KAAK,UAAD,OAAYlF,EAAK,GACrB+Q,SAAS,EACTuB,QAAS,GACT7O,YAAa,GACb/C,OAAQ,GACRvC,eAAgB,EAChByG,cAAe,GACf2N,eAAgB,MAIlBC,EtB2BkB,WACxB,IAAMtT,EAAc,CAElB,CAAC,IAAK,IAAK,IAAK,IAAK,KACrB,CAAC,IAAK,IAAK,IAAK,IAAK,KACrB,CAAC,IAAK,IAAK,IAAK,IAAK,KACrB,CAAC,IAAK,IAAK,IAAK,IAAK,KACrB,CAAC,IAAK,IAAK,IAAK,IAAK,MACrByH,QAAQ,SAAArI,GAAY,OACpBF,EAA+BR,EAAYU,KAG7C,OAAOW,EAAaC,GsBvCPuT,GAEbvR,EAAQsR,GAER,IAAMxQ,EAAiB,CACrB,CACEhE,MAAO,EACPgD,MAAOwR,EAAKjV,OAAO,SAAAC,GAAC,OAAgB,IAAZA,EAAEQ,QAC1B+C,aAAcyL,MAAM,GAAGC,KAAK,OAE9B,CACEzO,MAAO,EACPgD,MAAOwR,EAAKjV,OAAO,SAAAC,GAAC,OAAgB,IAAZA,EAAEQ,QAC1B+C,aAAcyL,MAAM,GAAGC,KAAK,OAE9B,CACEzO,MAAO,EACPgD,MAAOwR,EAAKjV,OAAO,SAAAC,GAAC,OAAgB,IAAZA,EAAEQ,QAC1B+C,aAAcyL,MAAM,GAAGC,KAAK,QAyBhC9L,EAAqBqB,GAWrB,MAAO,CACLA,iBACAC,gBAXsB,CACtBtE,KAAM,EACN+U,QAAS,EACTC,KAAM,EACNC,KAAM,EACNC,SAAU,EACVC,QAAS,GAMT7O,YDpEFsD,QAEAiB,KAAM,CACJuK,UAAW,EACXC,QAAS,SAACrL,EAAGV,GACXU,EAAEzD,gBAAkB+C,EAAIJ,eAE1BoM,MAAO,SAACtL,EAAGV,GAETtG,EAAqBgH,EAAE3F,kBAG3BkR,MAAO,SAACvL,GACN,IAAMwL,EAAUxL,EAAE1D,QAAQ1G,OAAO,SAAAC,GAAC,OAAIA,EAAEW,gBAAkB,KAE1D,GAAIgV,EAAQpV,OAAQ,CAClB,IAAMoN,EAAW,YAAIxD,EAAE1D,SAASmP,KAC9B,SAACC,EAAGC,GAAJ,OAAUA,EAAEnV,eAAiBkV,EAAElV,iBAEjC,MAAO,CAAEyM,OAAQuI,EAAQ,GAAIhI,eERpBoI,GAbIC,YAAqC,YAAmB,IAAhBC,EAAe,EAAfA,SACnDC,EAAOC,YAAO,CAClBC,QACA/D,SACAgE,KACAxB,WAAYoB,EAASK,gBACrBC,YAAaN,EAASM,YACtB7C,OAAO8C,IAGT,OAAO,kBAACN,EAAD,QCdHxB,GAAesB,YAAS,WAC5B,OACE,kBAAC,GAAD,CACEC,SAAU,CACRvC,OAAO8C,EACPF,gBAAiB,EACjBG,YAAa,EACbC,UAAW,EACXjQ,QAAS,QAKjBiO,GAAaiC,YAAc,eAEZjC,UCPTkC,GAAcC,QACW,cAA7B/C,OAAOC,SAAS+C,UAEe,UAA7BhD,OAAOC,SAAS+C,UAEhBhD,OAAOC,SAAS+C,SAASC,MACvB,2DA8CN,SAASC,GAAgBC,EAAeC,GACtCC,UAAUC,cACPC,SAASJ,GACTK,KAAK,SAAAC,GACJA,EAAaC,cAAgB,WAC3B,IAAMC,EAAmBF,EAAaG,WACd,MAApBD,IAGJA,EAAiBE,cAAgB,WACA,cAA3BF,EAAiBnR,QACf6Q,UAAUC,cAAcQ,YAI1B/N,QAAQgO,IACN,iHAKEX,GAAUA,EAAOY,UACnBZ,EAAOY,SAASP,KAMlB1N,QAAQgO,IAAI,sCAGRX,GAAUA,EAAOa,WACnBb,EAAOa,UAAUR,UAO5BS,MAAM,SAAAlO,GACLD,QAAQC,MAAM,4CAA6CA,KClGjEmO,IAASC,OAAO,kBCHD,kBAAM,kBAACC,GAAD,ODGL,MAASC,SAASC,eAAe,SDqB1C,SAAkBnB,GACvB,GAA6C,kBAAmBC,UAAW,CAMzE,GAJkB,IAAImB,IACnB9B,YACD1C,OAAOC,SAASwE,MAEJC,SAAW1E,OAAOC,SAASyE,OAIvC,OAGF1E,OAAO2E,iBAAiB,OAAQ,WAC9B,IAAMxB,EAAK,UAAMT,YAAN,sBAEPI,KAgEV,SAAiCK,EAAeC,GAE9CwB,MAAMzB,GACHK,KAAK,SAAAqB,GAEJ,IAAMC,EAAcD,EAASE,QAAQC,IAAI,gBAEnB,MAApBH,EAASI,QACO,MAAfH,IAA8D,IAAvCA,EAAY3W,QAAQ,cAG5CkV,UAAUC,cAAc4B,MAAM1B,KAAK,SAAAC,GACjCA,EAAa0B,aAAa3B,KAAK,WAC7BxD,OAAOC,SAASC,aAKpBgD,GAAgBC,EAAOC,KAG1Bc,MAAM,WACLnO,QAAQgO,IACN,mEArFAqB,CAAwBjC,EAAOC,GAI/BC,UAAUC,cAAc4B,MAAM1B,KAAK,WACjCzN,QAAQgO,IACN,gHAMJb,GAAgBC,EAAOC,MC/C/BE,I","file":"static/js/main.c82c529c.chunk.js","sourcesContent":["export interface GameContext {\n  allowedMoves: [];\n  currentPlayer: string;\n  turn: number;\n}\n\nexport enum ResourceType {\n  Wild = \"Wild\",\n  Emerald = \"Emerald\",\n  Sapphire = \"Sapphire\",\n  Ruby = \"Ruby\",\n  Diamond = \"Diamond\",\n  Onyx = \"Onyx\"\n}\n\nexport type ResourceTypes = keyof typeof ResourceType;\n\nexport const AllResourceTypes: ResourceType[] = Object.freeze(\n  Object.keys(ResourceType)\n    .filter(x => typeof x === \"string\")\n    .map(x => ResourceType[x] as ResourceType)\n) as ResourceType[];\n\nexport const NativeResourceTypes = Object.freeze(\n  Object.keys(ResourceType).filter(x => x !== ResourceType.Wild)\n);\n\nexport type ResourceCount = { [key in ResourceTypes]?: number | undefined };\n\nexport interface Resource {\n  readonly kind: ResourceType;\n}\n\nexport interface ResourceTotals {\n  tokens?: ResourceCount;\n  cards?: ResourceCount;\n}\n\nexport interface DevelopmentCard {\n  readonly id: string;\n  readonly level: number;\n  readonly cost: ResourceTotals;\n  readonly resourceType: ResourceType;\n  readonly prestigePoints: number;\n}\n\nexport interface Patron {\n  readonly name: string;\n  readonly cost: ResourceTotals;\n  readonly prestigePoints: number;\n}\n\nexport interface Player {\n  id: string;\n  name: string;\n  isHuman: boolean;\n  patrons: Patron[];\n  playedCards: DevelopmentCard[];\n  reservedCards: DevelopmentCard[];\n  tokens: ResourceCount;\n  prestigePoints: number;\n}\n\nexport interface DevelopmentCardRow {\n  level: number;\n  stock: DevelopmentCard[];\n  visibleCards: DevelopmentCard[];\n}\n\nexport interface GameState {\n  availableCards: DevelopmentCardRow[];\n  availableTokens: ResourceCount;\n  players: Player[];\n  currentPlayerId: string;\n}\n\nexport interface GameResults {\n  winner: Player;\n  rankings: Player[];\n}\n","import {\n  DevelopmentCard,\n  ResourceType,\n  ResourceTotals,\n  NativeResourceTypes\n} from \"../Model\";\n\n/*\n    CSV file contains the definitions for ONE color,\n    so use this as a blueprint to loop through all the colors\n  */\nconst blueprints = `\n1,E,{A} & {B} & {B},0\n1,E,{A} & {A} & {C} & {C},0\n1,E,{C} & {C} & {C},0\n1,E,{A} & {B} & {C} & {D},0\n1,E,{A} & {C} & {C} & {D} & {D},0\n1,E,{A} & {B} & {C} & {D} & {D},0\n1,E,{D} & {D} & {D} & {D},1\n\n2,E,{D} & {D} & {D} & {A} & {A} & {B} & {B}, 1\n2,E,{E} & {E} & {C} & {C} & {C} & {B} & {B} & {B}, 1\n2,E,{B} & {B} & {B} & {B} & {D} & {A} & {A}, 2\n2,E,{B} & {B} & {B} & {B} & {B}, 2\n2,E,{B} & {B} & {B} & {B} & {B} & {A} & {A} & {A}, 2\n2,E,{E} & {E} & {E} & {E} & {E} & {E}, 3\n\n3,E,{C} & {C} & {C} & {D} & {D} & {D} & {A} & {A} & {A} & {B} & {B} & {B} & {B} & {B},3\n3,E,{A} & {A} & {A} & {A} & {A} & {A} & {A},4\n3,E,{A} & {A} & {A} & {A} & {A} & {A} & {E} & {E} & {E} & {B} & {B} & {B},4\n3,E,{A} & {A} & {A} & {A} & {A} & {A} & {A} & {E} & {E} & {E},5`\n  .split(/\\n/)\n  .filter(line => line && line.length)\n  .map(line => line.split(\",\"))\n  .map(\n    ([level, resourceType, cost, prestigePoints]) =>\n      ({\n        level,\n        resourceType,\n        cost,\n        prestigePoints\n      } as DevelopmentCardDefinition)\n  );\n\ntype DevelopmentCardDefinition = {\n  [key in keyof Omit<DevelopmentCard, \"id\">]: string;\n};\n\nexport const importDeck = () => {\n  const definitions = [\n    // matrix containing all variations of the placeholders coming first\n    [\"A\", \"B\", \"C\", \"D\", \"E\"],\n    [\"B\", \"C\", \"D\", \"E\", \"A\"],\n    [\"C\", \"D\", \"E\", \"A\", \"B\"],\n    [\"D\", \"E\", \"A\", \"B\", \"C\"],\n    [\"E\", \"A\", \"B\", \"C\", \"D\"]\n  ].flatMap(placeholders =>\n    convertBlueprintsToDefinitions(blueprints, placeholders)\n  );\n\n  return generateDeck(definitions);\n};\n\n/** Generates the set of cards from the blueprint for a single resource */\nconst convertBlueprintsToDefinitions = (\n  blueprint,\n  placeholders\n): DevelopmentCardDefinition[] => {\n  // create the mapping from placeholders to their actual values,\n  // e.g. \"A\" -> \"Gold\", \"B\" -> \"Silver\", etc.\n  const resourceMap = placeholders.reduce((map, x, idx) => {\n    map[x] = NativeResourceTypes[idx];\n    return map;\n  }, {});\n\n  return blueprint.map(\n    ({ cost, level, prestigePoints, resourceType }) =>\n      ({\n        cost: replacePlaceholders(cost, placeholders, resourceMap),\n        level: level,\n        prestigePoints: prestigePoints,\n        resourceType: resourceMap[resourceType]\n      } as DevelopmentCardDefinition)\n  );\n};\n\nconst replacePlaceholders = (source, placeholders, replacements) =>\n  placeholders.reduce(\n    (replaced, placeholder) =>\n      replaced.replace(\n        new RegExp(`{${placeholder}}`, \"g\"),\n        replacements[placeholder]\n      ),\n    source\n  );\n\nexport const generateDeck = (definitions: DevelopmentCardDefinition[]) =>\n  definitions.filter(isValidDefinition).map(toDevelopmentCard);\n\nconst isValidDefinition = (definition: DevelopmentCardDefinition) =>\n  definition &&\n  !!definition.cost &&\n  isANumber(definition.level, 1, 3) &&\n  isResourceType(definition.resourceType) &&\n  isANumber(definition.prestigePoints, 0, 10);\n\nconst isResourceType = value => Object.keys(ResourceType).indexOf(value) > -1;\n\nconst isANumber = (input: string, min: number, max: number) =>\n  ((parsed: number) => !Number.isNaN(parsed) && parsed >= min && parsed <= max)(\n    Number(input)\n  );\n\nconst toDevelopmentCard = (\n  { cost, level, prestigePoints, resourceType }: DevelopmentCardDefinition,\n  id: number\n): DevelopmentCard => ({\n  id: `${id}_L${level}_${resourceType}`,\n  level: Number(level),\n  resourceType: ResourceType[resourceType],\n  cost: parseCost(cost),\n  prestigePoints: Number(prestigePoints)\n});\n\nconst parseCost = (cost: string): ResourceTotals =>\n  (cost || \"\")\n    .split(\"&\")\n    .map(x => x.trim())\n    .reduce(\n      (totals, resource) => {\n        const isCard = resource.endsWith(\"Card\");\n\n        const resourceType = isCard\n          ? resource.substr(0, resource.length - \"Card\".length)\n          : resource;\n\n        const costGroup = totals[isCard ? \"cards\" : \"tokens\"];\n        costGroup[resourceType] = (costGroup[resourceType] || 0) + 1;\n\n        return totals;\n      },\n      { cards: {}, tokens: {} } as ResourceTotals\n    );\n","import { DevelopmentCardRow } from \"../Model\";\n\nexport const populateVisibleCards = (cardRows: DevelopmentCardRow[]) => {\n  cardRows.forEach(row => {\n    for (let x = 0; x < row.visibleCards.length; x++) {\n      if (row.visibleCards[x] == null && row.stock.length !== 0) {\n        row.visibleCards[x] = row.stock.pop();\n      }\n    }\n  });\n};\n","/**\n * Randomly shuffle an array\n * https://stackoverflow.com/a/2450976/1293256\n * @param  {Array} array The array to shuffle\n * @return {String}      The first item in the shuffled array\n */\nexport const shuffle = function(array) {\n  var currentIndex = array.length;\n  var temporaryValue, randomIndex;\n\n  // While there remain elements to shuffle...\n  while (0 !== currentIndex) {\n    // Pick a remaining element...\n    randomIndex = Math.floor(Math.random() * currentIndex);\n    currentIndex -= 1;\n\n    // And swap it with the current element.\n    temporaryValue = array[currentIndex];\n    array[currentIndex] = array[randomIndex];\n    array[randomIndex] = temporaryValue;\n  }\n\n  return array;\n};\n","import {\n  ResourceTotals,\n  Resource,\n  ResourceType,\n  ResourceCount,\n  ResourceTypes,\n  NativeResourceTypes,\n  DevelopmentCard,\n  Player,\n  GameState\n} from \"../Model\";\n\nexport const deduct = (\n  cost: ResourceCount,\n  from: ResourceCount\n): ResourceCount =>\n  Object.keys(cost).reduce(\n    (deducted, resourceType) => {\n      if (deducted[resourceType] != null) {\n        deducted[resourceType] = deducted[resourceType] - cost[resourceType];\n      } else {\n        deducted[resourceType] = -cost[resourceType];\n      }\n\n      return deducted;\n    },\n    // clone the input\n    Object.assign({}, from || {}) as ResourceCount\n  );\n\nexport const getGemCount = (\n  tokens: (Resource | ResourceType | ResourceTypes)[]\n): ResourceCount =>\n  Object.keys(ResourceType).reduce((counts, color) => {\n    const total = tokens\n      .map(x => (typeof x === \"string\" ? color : x.kind))\n      .filter(x => x === color).length;\n\n    counts[color] = (counts[color] == null ? 0 : counts[color]) + total;\n\n    return counts;\n  }, {}) as ResourceCount;\n\nexport const createResourceCollection = (): ResourceCount =>\n  Object.keys(ResourceType).reduce(\n    // eslint-disable-next-line\n    (bag, color) => ((bag[color] = 0), bag),\n    {} as ResourceCount\n  );\n\n/**\n * Determines what a player will have to pay in order to purchase an item\n *\n * @param required the item's cost\n * @param available the resources currently available\n *\n * @returns the set of resources that will satisfy the required cost\n * Any resource requirements that can't be met will be identified with a negative cost\n */\nexport const calculatePayment = (\n  required: ResourceTotals,\n  available: ResourceTotals\n): ResourceTotals => {\n  const availableCards = (available && available.cards) || {};\n  const availableTokens = (available && available.tokens) || {};\n  const requiredCards = (required && required.cards) || {};\n  const requiredTokens = (required && required.tokens) || {};\n\n  // store this outside so we can keep track as we use them\n  let availableWilds = availableTokens[ResourceType.Wild] || 0;\n\n  let cost = {\n    cards: createResourceCollection(),\n    tokens: createResourceCollection()\n  };\n\n  for (let color of NativeResourceTypes) {\n    const availableCardsOfColor = availableCards[color] || 0;\n    const availableTokensOfColor = availableTokens[color] || 0;\n    const requiredCardsOfColor = requiredCards[color] || 0;\n    const requiredTokensOfColor = requiredTokens[color] || 0;\n\n    // Don't waste time figuring out how to pay for things that aren't required\n    if (requiredCardsOfColor + requiredTokensOfColor === 0) {\n      continue;\n    }\n\n    /* Example:\n        Required: 3 Emeralds\n        Available Cards: 1 Emerald\n        Available Tokens: 1 Emerald, 1 Wild\n        == Cost:  1 Emerald, 1 Wild\n      */\n\n    // e.g. 3 Emeralds\n    let remainingRequiredTokens = requiredTokensOfColor;\n\n    // factor in the cards we have (i.e. tokens we get for \"free\");\n    // e.g. 3 Emeralds - 1 Emerald card = 2 Emeralds still required\n    const cardDiscount = Math.min(\n      remainingRequiredTokens,\n      availableCardsOfColor\n    );\n    remainingRequiredTokens -= cardDiscount;\n\n    // how many natural tokens do we have that we can use?\n    // e.g. 2 Emeralds - 1 Emerald token = 1 Emerald still required\n    const naturalTokenCost = Math.min(\n      remainingRequiredTokens,\n      availableTokensOfColor\n    );\n    remainingRequiredTokens -= naturalTokenCost;\n\n    // e.g. 1 Emeralds - 1 Wild token = 0 Emeralds still required\n    const wildCost = Math.min(remainingRequiredTokens, availableWilds);\n    remainingRequiredTokens -= wildCost;\n\n    // if we aren't able to satisfy the cost, even with wilds,\n    // report the deficit\n    if (remainingRequiredTokens > 0) {\n      cost.tokens[color] = -remainingRequiredTokens;\n    } else {\n      // we're all done with our maths so go ahead and update the return value\n      cost.tokens[color] = (cost.tokens[color] || 0) + naturalTokenCost;\n      cost.tokens[ResourceType.Wild] =\n        (cost.tokens[ResourceType.Wild] || 0) + wildCost;\n\n      // subtract the wilds we had to use from the ones available\n      // so they can't be used again\n      availableWilds -= wildCost;\n    }\n\n    // card costs can only be paid with cards (only report missing cards)\n    const cardDeficit = Math.max(\n      0,\n      requiredCardsOfColor - availableCardsOfColor\n    );\n    cost.cards[color] = (cost.cards[color] || 0) - cardDeficit;\n  }\n\n  return cost;\n};\n\nexport const hasRequiredResources = (\n  required: ResourceTotals,\n  available?: ResourceTotals\n): boolean => {\n  const cost = available ? calculatePayment(required, available) : required;\n  const missingCards = requiresAdditionalResources(cost.cards);\n  const missingResources = requiresAdditionalResources(cost.tokens);\n  return !(missingCards || missingResources);\n};\n\nconst requiresAdditionalResources = (target: ResourceCount | undefined) =>\n  target == null ? false : Object.keys(target).some(key => target[key] < 0);\n\nexport const add = (\n  target: ResourceCount,\n  toMerge: ResourceCount\n): ResourceCount =>\n  Object.keys(toMerge).reduce(\n    (sum, resourceType) => {\n      if (sum[resourceType] != null) {\n        sum[resourceType] = sum[resourceType] + toMerge[resourceType];\n      } else {\n        sum[resourceType] = toMerge[resourceType];\n      }\n\n      return sum;\n    },\n    // clone the input\n    Object.assign({}, target || {}) as ResourceCount\n  );\n\nexport const times = count => <TResult>(\n  f: (i?: number) => TResult\n): TResult[] => {\n  let results: TResult[] = [];\n\n  for (let i = 0; i < count; i++) {\n    results.push(f(i));\n  }\n\n  return results;\n};\n\nexport const randomItem = <T>(items: T[]): T =>\n  items[Math.floor(Math.random() * items.length)];\n\nexport const waitFor = (predicate: () => boolean) =>\n  new Promise((done, reject) => {\n    let count = 0;\n    let timer = setInterval(() => {\n      if (predicate()) {\n        done();\n        clearInterval(timer);\n      } else if (++count >= 10) {\n        reject();\n      }\n    }, 100);\n  });\n\nexport const getCardResourceCount = (cards: DevelopmentCard[]): ResourceCount =>\n  cards.reduce(\n    (cardResources, card) => {\n      cardResources[card.resourceType] =\n        (cardResources[card.resourceType] || 0) + 1;\n      return cardResources;\n    },\n    {} as ResourceCount\n  );\n\nexport const calculatePlayerResourceTotals = ({\n  playedCards,\n  tokens\n}: Player) => ({\n  tokens: tokens,\n  cards: calculateCardResources(playedCards)\n});\n\nexport const calculateCardResources = (cards: DevelopmentCard[]) =>\n  cards.reduce(\n    (cardResources, card) => {\n      cardResources[card.resourceType] =\n        (cardResources[card.resourceType] || 0) + 1;\n      return cardResources;\n    },\n    {} as ResourceCount\n  );\n\nexport const calculatePlayerPrestigePoints = ({\n  patrons,\n  playedCards\n}: Player) =>\n  [...patrons, ...playedCards].reduce(\n    (total, x) => (total += x.prestigePoints),\n    0\n  );\n\nexport const recalculatePlayerTotals = (\n  playerOrState: Player | GameState\n): void => {\n  if (\"id\" in playerOrState) {\n    const player = playerOrState;\n    player.prestigePoints = calculatePlayerPrestigePoints(player);\n  } else {\n    playerOrState.players.forEach(recalculatePlayerTotals);\n  }\n};\n\nexport const findCurrentPlayer = (state: GameState): Player => {\n  const player = findPlayer(state.players, state.currentPlayerId);\n  if (player == null) {\n    throw new Error(\"Couldn't find current player\");\n  }\n  return player;\n};\n\nexport const findPlayer = (\n  players: Player[],\n  playerId: string\n): Player | null =>\n  players == null ? null : players.find(x => x.id === playerId);\n\nexport const clone = <T>(source: T): T => JSON.parse(JSON.stringify(source));\n","import { DevelopmentCard, GameState } from \"../Model\";\nimport { findCurrentPlayer } from \"./utils\";\n\nexport const takeDevelopmentCard = (\n  state: GameState,\n  card: DevelopmentCard\n) => {\n  const player = findCurrentPlayer(state);\n\n  for (let row of state.availableCards) {\n    const matchesCardId = (x: DevelopmentCard) => x && x.id === card.id;\n\n    const topStockCard = row.stock[row.stock.length - 1];\n    const isStockCard = matchesCardId(topStockCard);\n\n    const visibleCardIndex = row.visibleCards.findIndex(matchesCardId);\n    const isVisibleCard = visibleCardIndex > -1;\n\n    if (isStockCard) {\n      row.stock.pop();\n      player.reservedCards.push(card);\n      return;\n    } else if (isVisibleCard) {\n      row.visibleCards[visibleCardIndex] = null;\n      player.reservedCards.push(card);\n      return;\n    }\n  }\n\n  throw new Error(\n    `Couldn't find card ${JSON.stringify(\n      card\n    )} in top card of stock piles or visible cards`\n  );\n};\n","import { GameState } from \"../../../Model\";\nimport { moves } from \"./index\";\n\nexport interface PlayerAction {}\n\ntype PlayerActionCommandType = typeof PlayerActionCommand;\n\nexport type AvailableMove = { move: keyof typeof moves; args: any[] };\n\nexport interface PlayerActionCommandStatic extends PlayerActionCommandType {\n  getAvailableMoves(gameState: GameState): AvailableMove[];\n}\n\nexport abstract class PlayerActionCommand<T = any> {\n  hash(): string {\n    return JSON.stringify({\n      name: (this as any).__proto__.constructor.name,\n      action: this.action\n    });\n  }\n\n  constructor(public readonly action: T) {}\n  abstract execute(gameState: GameState): GameState;\n}\n","import { GameState, ResourceType, NativeResourceTypes } from \"../../../Model\";\nimport {\n  PlayerActionCommand,\n  PlayerAction,\n  AvailableMove\n} from \"./PlayerAction\";\nimport { findCurrentPlayer } from \"../../../util\";\n\nexport interface CollectMultipleResources extends PlayerAction {\n  resources: ResourceType[];\n}\n\nexport class CollectMultipleResourcesCommand extends PlayerActionCommand<\n  CollectMultipleResources\n> {\n  execute(state: GameState) {\n    for (let resource of this.action.resources) {\n      state.availableTokens[resource] =\n        (state.availableTokens[resource] || 0) - 1;\n\n      findCurrentPlayer(state).tokens[resource] =\n        (findCurrentPlayer(state).tokens[resource] || 0) + 1;\n    }\n\n    return state;\n  }\n\n  static readonly getAvailableMoves = (state: GameState): AvailableMove[] => {\n    const availableResources = NativeResourceTypes.filter(\n      type => state.availableTokens[type] > 0\n    ).map(x => ResourceType[x] as ResourceType);\n\n    // not enough resources to take three\n    if (availableResources.length < 3) return [];\n\n    // return all combinations of the available resources\n    let actions: [ResourceType, ResourceType, ResourceType][] = [];\n\n    for (let x of availableResources) {\n      for (let y of availableResources.filter(n => n !== x)) {\n        for (let z of availableResources.filter(n => n !== x && n !== y)) {\n          actions.push([x, y, z]);\n        }\n      }\n    }\n\n    return actions.map(resources => ({\n      move: \"collectMultipleResources\",\n      args: [resources]\n    }));\n  };\n}\n","import { GameState, ResourceType, NativeResourceTypes } from \"../../../Model\";\nimport {\n  PlayerAction,\n  PlayerActionCommand,\n  AvailableMove\n} from \"./PlayerAction\";\nimport { findCurrentPlayer } from \"../../../util\";\n\nexport interface CollectSingleResource extends PlayerAction {\n  resource: ResourceType;\n}\n\nexport class CollectSingleResourceCommand extends PlayerActionCommand<\n  CollectSingleResource\n> {\n  execute(state: GameState) {\n    state.availableTokens[this.action.resource] =\n      (state.availableTokens[this.action.resource] || 0) - 2;\n\n    const player = findCurrentPlayer(state);\n\n    player.tokens[this.action.resource] =\n      (player.tokens[this.action.resource] || 0) + 2;\n\n    return state;\n  }\n\n  static readonly getAvailableMoves = (state: GameState): AvailableMove[] =>\n    NativeResourceTypes.filter(type => state.availableTokens[type] >= 2)\n      .map(x => ResourceType[x])\n      .map(resource => ({ move: \"collectSingleResource\", args: [resource] }));\n}\n","import { DevelopmentCard, GameState, ResourceTotals } from \"../../../Model\";\nimport {\n  PlayerAction,\n  PlayerActionCommand,\n  AvailableMove\n} from \"./PlayerAction\";\nimport {\n  hasRequiredResources,\n  calculatePayment,\n  deduct,\n  add,\n  calculatePlayerResourceTotals,\n  findCurrentPlayer,\n  takeDevelopmentCard,\n  calculateCardResources\n} from \"../../../util\";\n\nexport interface PurchaseDevelopmentCard extends PlayerAction {\n  card: DevelopmentCard;\n}\n\nexport class PurchaseDevelopmentCardCommand extends PlayerActionCommand<\n  PurchaseDevelopmentCard\n> {\n  static readonly INSUFFICIENT_FUNDS =\n    \"Player has insufficient funds to purchase this card\";\n\n  static readonly UNAVAILABLE_CARD = \"Card is not available to play\";\n\n  execute(state: GameState) {\n    const card = this.action.card;\n\n    if (card == null) {\n      throw new Error(\"Can't purchase an empty card!\");\n    }\n\n    const player = findCurrentPlayer(state);\n\n    const payment = calculatePayment(\n      card.cost,\n      calculatePlayerResourceTotals(player)\n    );\n\n    if (!hasRequiredResources(payment)) {\n      throw new Error(PurchaseDevelopmentCardCommand.INSUFFICIENT_FUNDS);\n    }\n\n    const isOnTable = state.availableCards.some(row =>\n      row.visibleCards.some(x => x && x.id === card.id)\n    );\n\n    let reservedCard = player.reservedCards.find(x => x.id === card.id);\n\n    if (!reservedCard && !isOnTable) {\n      throw new Error(PurchaseDevelopmentCardCommand.UNAVAILABLE_CARD);\n    }\n\n    // pay for it first - take it from the player...\n    player.tokens = deduct(payment.tokens, player.tokens);\n\n    // ... and add it (back) to the bank\n    state.availableTokens = add(state.availableTokens, payment.tokens);\n\n    // take it from the table\n    if (isOnTable) {\n      takeDevelopmentCard(state, card);\n      reservedCard = card;\n    }\n\n    // take it from the player's hand\n    player.reservedCards.splice(player.reservedCards.indexOf(reservedCard), 1);\n\n    // add the card to the collection of played cards\n    player.playedCards.push(card);\n\n    player.prestigePoints = (player.prestigePoints || 0) + card.prestigePoints;\n\n    return state;\n  }\n\n  static readonly getAvailableMoves = (state: GameState): AvailableMove[] => {\n    const visibleCards = state.availableCards.flatMap(x => x.visibleCards);\n    const { reservedCards } = findCurrentPlayer(state);\n    const accessibleCards = [...visibleCards, ...reservedCards].filter(\n      x => x != null\n    );\n\n    const currentPlayer = findCurrentPlayer(state);\n\n    const playerResources: ResourceTotals = {\n      tokens: currentPlayer.tokens,\n      cards: calculateCardResources(currentPlayer.playedCards)\n    };\n\n    const playableCards = accessibleCards.filter(card =>\n      hasRequiredResources(card.cost, playerResources)\n    );\n\n    return playableCards.map(card => ({\n      move: \"purchaseDevelopmentCard\",\n      args: [card]\n    }));\n  };\n}\n","import { DevelopmentCard, GameState } from \"../../../Model\";\nimport {\n  PlayerAction,\n  PlayerActionCommand,\n  AvailableMove\n} from \"./PlayerAction\";\nimport { findCurrentPlayer, takeDevelopmentCard } from \"../../../util\";\n\nexport interface ReserveDevelopmentCard extends PlayerAction {\n  card: DevelopmentCard;\n}\n\nexport class ReserveDevelopmentCardCommand extends PlayerActionCommand<\n  ReserveDevelopmentCard\n> {\n  execute(state: GameState): GameState {\n    const card = this.action.card;\n\n    if (card == null) {\n      throw new Error(\"Can't reserve an empty card!\");\n    }\n\n    const player = findCurrentPlayer(state);\n\n    // give the player a wild token\n    if (state.availableTokens.Wild > 0) {\n      player.tokens.Wild = (player.tokens.Wild || 0) + 1;\n      state.availableTokens.Wild = (state.availableTokens.Wild || 0) - 1;\n    }\n\n    // take the card off the table and add a new one in its place\n    takeDevelopmentCard(state, card);\n\n    return state;\n  }\n\n  static readonly getAvailableMoves = (state: GameState): AvailableMove[] => {\n    const player = findCurrentPlayer(state);\n\n    if (player.reservedCards.length >= 4) {\n      return [];\n    }\n\n    return state.availableCards\n      .flatMap(x => x.visibleCards)\n      .filter(x => x != null)\n      .map(card => ({ move: \"reserveDevelopmentCard\", args: [card] }));\n  };\n}\n","import { CollectMultipleResourcesCommand } from \"./collectMultipleResources\";\nimport { CollectSingleResourceCommand } from \"./collectSingleResource\";\nimport { PurchaseDevelopmentCardCommand } from \"./purchaseDevelopmentCard\";\nimport { ReserveDevelopmentCardCommand } from \"./reserveDevelopmentCard\";\nimport { PlayerActionCommand } from \"./PlayerAction\";\nimport { GameContext, GameState } from \"../../../Model\";\nimport { findCurrentPlayer } from \"../../../util\";\n\ninterface GameActionHandler {\n  (G: GameState, ctx: GameContext, ...args): GameState;\n}\n\nexport const getAvailableMoves = (state: GameState) =>\n  [\n    CollectMultipleResourcesCommand,\n    CollectSingleResourceCommand,\n    PurchaseDevelopmentCardCommand,\n    ReserveDevelopmentCardCommand\n  ].flatMap(cmd => cmd.getAvailableMoves(state));\n\nconst executeCommand = (\n  state: GameState,\n  ctx: GameContext,\n  CommandType: { new (...args): PlayerActionCommand },\n  args?\n): GameState => {\n  try {\n    const cmd = new CommandType(args);\n    return cmd.execute(state);\n  } catch (err) {\n    console.error(err);\n    return state;\n  }\n};\n\nexport const moves: { [key: string]: GameActionHandler } = {\n  triggerWin: g => {\n    const player = findCurrentPlayer(g);\n    player.prestigePoints = 15;\n    return g;\n  },\n  collectMultipleResources: (G, ctx, resources) =>\n    executeCommand(G, ctx, CollectMultipleResourcesCommand, {\n      resources\n    }),\n\n  collectSingleResource: (G, ctx, resource) =>\n    executeCommand(G, ctx, CollectSingleResourceCommand, { resource }),\n\n  purchaseDevelopmentCard: (G, ctx, card) =>\n    executeCommand(G, ctx, PurchaseDevelopmentCardCommand, { card }),\n\n  reserveDevelopmentCard: (G, ctx, card) =>\n    executeCommand(G, ctx, ReserveDevelopmentCardCommand, { card })\n};\n\nexport default moves;\n","import { AI, MCTSBot } from \"boardgame.io/ai\";\nimport { IGameCtx } from \"boardgame.io/core\";\nimport { GameState } from \"Model\";\nimport { findPlayer } from \"../util\";\nimport { getAvailableMoves } from \"./game/moves\";\n\nconst objective = (\n  multiplier: number,\n  calculateScore: (targetState: GameState) => number\n) => ({\n  weight: 0,\n  checker: function(state: GameState) {\n    const score = calculateScore(state);\n    this.weight = score * multiplier;\n    return this.weight > 0;\n  }\n});\n\nclass Bot extends MCTSBot {\n  constructor(args) {\n    super({\n      ...args,\n      iterations: (_, ctx: IGameCtx) => 100 + ctx.turn * 2,\n      playoutDepth: (_, ctx: IGameCtx) => 50,\n      objectives: function(\n        initialState: GameState,\n        _: IGameCtx,\n        playerId: string\n      ) {\n        if (!playerId) return {};\n\n        const player = findPlayer(initialState.players, playerId);\n\n        return {\n          winGame: objective(\n            Number.POSITIVE_INFINITY,\n            (targetState: GameState): number =>\n              findPlayer(targetState.players, playerId).prestigePoints >= 15\n                ? 1\n                : 0\n          ),\n          increasePrestigePoints: objective(\n            50,\n            (targetState: GameState): number =>\n              findPlayer(targetState.players, playerId).prestigePoints -\n              player.prestigePoints\n          )\n        };\n      }\n    });\n  }\n}\n\nexport default AI({\n  bot: Bot,\n  enumerate: getAvailableMoves\n});\n","import React from \"react\";\nimport { Box } from \"@material-ui/core\";\nimport { styled } from \"@material-ui/styles\";\n\nexport const Column = styled(Box)({ display: \"flex\", flexDirection: \"column\" });\n\nexport const Row = styled(Box)({ display: \"flex\", flexDirection: \"row\" });\n\ninterface OverlayProps {\n  isActive: boolean;\n  className?: string;\n}\nexport const Overlay = styled(({ className }: OverlayProps) => (\n  <div className={className} />\n))({\n  position: \"absolute\",\n  top: 0,\n  left: 0,\n  width: \"100vw\",\n  height: ({ isActive }) => `${isActive ? 100 : 0}vh`,\n  zIndex: 1000\n});\n","import {\n  Button,\n  Dialog,\n  DialogActions,\n  DialogContent,\n  DialogTitle,\n  List,\n  ListItem,\n  ListItemIcon,\n  ListItemSecondaryAction,\n  ListItemText,\n  Typography\n} from \"@material-ui/core\";\nimport React from \"react\";\nimport { GameResults, Player } from \"../../Model\";\n\ninterface GameOverProps {\n  userPlayer: Player;\n  results: GameResults;\n  onClose(): any;\n}\n\nexport const GameOver = ({ results, onClose, userPlayer }: GameOverProps) => (\n  <Dialog open onClose={onClose} aria-labelledby=\"customized-dialog-title\">\n    <DialogTitle>\n      {results.winner === userPlayer ? (\n        <Typography variant=\"h3\">YOU WIN!</Typography>\n      ) : (\n        <Typography variant=\"h3\">You Lose!</Typography>\n      )}\n    </DialogTitle>\n    <DialogContent dividers>\n      <Typography gutterBottom variant=\"h4\">\n        Player Rankings\n      </Typography>\n      <List>\n        {results.rankings.map((player, idx) => (\n          <ListItem\n            key={player.id}\n            style={{\n              fontWeight: 800,\n              color: player === userPlayer ? \"blue\" : \"\"\n            }}\n          >\n            <ListItemIcon>\n              <span>{idx + 1}</span>\n            </ListItemIcon>\n            <ListItemText primary={player.name} />\n            <ListItemSecondaryAction>\n              {player.prestigePoints}\n            </ListItemSecondaryAction>\n          </ListItem>\n        ))}\n      </List>\n    </DialogContent>\n    <DialogActions>\n      <Button onClick={onClose} color=\"primary\">\n        New Game\n      </Button>\n    </DialogActions>\n  </Dialog>\n);\n","import React from \"react\";\nimport * as Model from \"../../Model\";\n\nexport const DevelopmentCard = ({\n  card,\n  onSelected,\n  canSelect\n}: {\n  card: Model.DevelopmentCard;\n  canSelect?: boolean;\n  onSelected(card: Model.DevelopmentCard): void;\n}) => (\n  <div\n    className={`card ${card.id || canSelect ? \"valid-action\" : \"\"} ${\n      card.resourceType\n    }`}\n    itemProp=\"card\"\n    onClick={() => (card.id || canSelect ? onSelected(card) : false)}\n  >\n    <div itemProp=\"resource\" data-value={card.resourceType} />\n    {card && card.prestigePoints > 0 && (\n      <div itemProp=\"prestigePoints\" data-value={card.prestigePoints} />\n    )}\n    <div itemProp=\"cost\">\n      {card &&\n        card.cost &&\n        Model.AllResourceTypes.filter(\n          resource => card.cost.tokens[resource] > 0\n        ).map(resource => (\n          <div key={resource} itemProp=\"token\">\n            <div itemProp=\"resource\" data-value={resource} />\n            <div itemProp=\"count\" data-value={card.cost.tokens[resource]} />\n          </div>\n        ))}\n    </div>\n  </div>\n);\n","import React from \"react\";\nimport * as Model from \"../../Model\";\nimport { DevelopmentCard } from \"./DevelopmentCard\";\n\nexport const CommunityCards = ({ availableCards, selectDevelopmentCard }) => (\n  <>\n    {availableCards.map((row, rowIndex) => (\n      <div key={String(rowIndex)} className=\"cardRow\">\n        <div\n          className=\"stock card valid-action\"\n          onClick={() =>\n            row.stock.length\n              ? selectDevelopmentCard(row.stock[row.stock.length - 1])\n              : false\n          }\n        >\n          <span>{row.stock.length}</span>\n        </div>\n        {Array(4)\n          .fill(0)\n          .map(\n            (_, i) =>\n              row.visibleCards[i] || ({ id: null } as Model.DevelopmentCard)\n          )\n          .map((card, idx) => (\n            <DevelopmentCard\n              key={card.id || `${row.level}${idx}`}\n              card={card}\n              onSelected={selectDevelopmentCard}\n            />\n          ))}\n      </div>\n    ))}\n  </>\n);\n","import React from \"react\";\nimport * as Model from \"../../Model\";\nimport { Column } from \"./components\";\nimport clsx from \"clsx\";\n\ninterface PlayedDevelopmentCardsProps {\n  cards: Model.DevelopmentCard[];\n}\n\nexport const GroupedDevelopmentCards = ({\n  cards\n}: PlayedDevelopmentCardsProps) => {\n  const groupedCards = Model.NativeResourceTypes.map(resourceType => ({\n    resourceType,\n    cards: cards.filter(x => x.resourceType === resourceType)\n  }));\n\n  return (\n    <>\n      {groupedCards.map(({ resourceType, cards }) => (\n        <Column\n          key={resourceType}\n          className={clsx(\"cardStack\", resourceType, {\n            empty: !cards || cards.length === 0\n          })}\n        >\n          {cards.length}\n        </Column>\n      ))}\n    </>\n  );\n};\n","import { AllResourceTypes, ResourceType, ResourceCount } from \"Model\";\nimport React from \"react\";\nimport clsx from \"clsx\";\n\ninterface TokensProps {\n  tokens: ResourceCount;\n  showEmpty?: boolean;\n  selectToken?(token: ResourceType): void;\n}\n\nexport const Tokens = ({\n  tokens,\n  selectToken,\n  showEmpty = true\n}: TokensProps) => (\n  <>\n    {AllResourceTypes.map(\n      token =>\n        (tokens[token] || showEmpty) && (\n          <div\n            key={token}\n            itemProp=\"token\"\n            className={clsx({ empty: (tokens[token] || 0) === 0 })}\n            onClick={() => selectToken && selectToken(token)}\n          >\n            <div itemProp=\"resource\" data-value={token} />\n            <div itemProp=\"count\" data-value={tokens[token] || 0} />\n          </div>\n        )\n    )}\n  </>\n);\n","import { Box, makeStyles, createStyles } from \"@material-ui/core\";\nimport React from \"react\";\nimport * as Model from \"../../Model\";\nimport { Column, Row } from \"./components\";\nimport { GroupedDevelopmentCards } from \"./GroupedDevelopmentCards\";\nimport { Tokens } from \"./Tokens\";\nimport { withStyles, WithStyles } from \"@material-ui/styles\";\nimport clsx from \"clsx\";\n\nconst styles = createStyles({\n  name: { flexGrow: 1 },\n  player: {},\n  tokens: { fontSize: \"0.5rem\", fontWeight: \"bold\" },\n  cards: { marginTop: \".1rem\", fontSize: \"1.5rem\", minHeight: \"3rem\" },\n  reservedCardStack: {\n    bgcolor: \"#ccc\",\n    position: \"relative\",\n    fontWeight: 600,\n    justifyContent: \"center\",\n    alignContent: \"center\"\n  }\n});\n\nconst useStyles = makeStyles(styles);\n\nexport const PlayerList = ({ players, currentPlayer }) => {\n  const classes = useStyles({});\n  return (\n    <>\n      {players.map((player: Model.Player) => (\n        <PlayerOverview\n          key={player.id}\n          classes={classes}\n          isCurrentPlayer={player === currentPlayer}\n          player={player}\n        />\n      ))}\n    </>\n  );\n};\n\ninterface PlayerOverviewProps extends WithStyles<typeof styles> {\n  isCurrentPlayer: boolean;\n  player: Model.Player;\n}\n\nconst PlayerOverview = withStyles(styles)(\n  ({ classes, isCurrentPlayer, player }: PlayerOverviewProps) => (\n    <Column\n      className={clsx(classes.player, \"player\", { active: isCurrentPlayer })}\n      itemScope\n      itemType=\"urn:x:player\"\n      itemID={String(player.id)}\n    >\n      <Row>\n        <Box className={classes.name} itemProp=\"name\">\n          {player.name}\n        </Box>\n        <Box fontWeight={800}>{player.prestigePoints}</Box>\n      </Row>\n      <Row className={classes.tokens}>\n        <Tokens tokens={player.tokens} />\n      </Row>\n      <Row className={classes.cards}>\n        <Column className={clsx(\"cardStack\", classes.reservedCardStack)}>\n          {(player.reservedCards && player.reservedCards.length) || 0}\n        </Column>\n        <GroupedDevelopmentCards cards={player.playedCards} />\n      </Row>\n    </Column>\n  )\n);\n","import { Box } from \"@material-ui/core\";\nimport { styled } from \"@material-ui/styles\";\nimport React from \"react\";\nimport * as Model from \"../../Model\";\nimport { Column, Row } from \"./components\";\nimport { DevelopmentCard } from \"./DevelopmentCard\";\nimport { GroupedDevelopmentCards } from \"./GroupedDevelopmentCards\";\nimport { Tokens } from \"./Tokens\";\nimport clsx from \"clsx\";\n\nconst CurrentPlayerName = styled(\"h3\")({\n  writingMode: \"vertical-lr\",\n  textOrientation: \"upright\"\n});\n\nconst ReservedCards = styled(Row)({\n  flexGrow: 1,\n  \"& > div:not(:first-child)\": {\n    marginLeft: \"-3rem\"\n  },\n  maxWidth: \"15em\",\n  padding: \"0 0.5rem\",\n  overflowY: \"auto\"\n});\n\nexport const UserPlayerInventory = ({\n  isCurrentPlayer,\n  player,\n  onPlayReservedCard\n}: {\n  isCurrentPlayer: boolean;\n  player: Model.Player;\n  onPlayReservedCard(card: Model.DevelopmentCard): void;\n}) => (\n  <Row\n    position=\"relative\"\n    flexGrow={1}\n    className={clsx(\"user-player\", { active: isCurrentPlayer })}\n  >\n    <CurrentPlayerName>{player.name}</CurrentPlayerName>\n    <Box\n      className=\"prestigePoints\"\n      width=\"2rem\"\n      fontSize=\"150%\"\n      fontWeight=\"800\"\n    >\n      {player.prestigePoints}\n    </Box>\n    <Row flexGrow={1}>\n      <Row border=\"1px solid #333\">\n        <Column\n          fontSize=\"calc(100% + .5rem/6)\"\n          alignItems=\"center\"\n          width=\"3rem\"\n          padding=\"1rem 0\"\n        >\n          <Tokens tokens={player.tokens} />\n        </Column>\n        <ReservedCards>\n          {player.reservedCards.map(card => (\n            <DevelopmentCard\n              key={card.id}\n              card={card}\n              onSelected={onPlayReservedCard}\n            />\n          ))}\n        </ReservedCards>\n      </Row>\n      <Row fontSize=\"5em\">\n        <GroupedDevelopmentCards cards={player.playedCards} />\n      </Row>\n    </Row>\n  </Row>\n);\n","import { Snackbar } from \"@material-ui/core\";\nimport { createStyles, makeStyles } from \"@material-ui/core/styles\";\nimport { IBoardProps } from \"boardgame.io/react\";\nimport React, { useCallback, useEffect, useState, useMemo } from \"react\";\nimport * as Model from \"../../Model\";\nimport {\n  calculatePlayerResourceTotals,\n  findPlayer,\n  hasRequiredResources\n} from \"../../util\";\nimport { Moves } from \"../game\";\nimport \"./board.css\";\nimport { Overlay } from \"./components\";\nimport { GameOver } from \"./GameOver\";\nimport { CommunityCards } from \"./CommunityCards\";\nimport { PlayerList } from \"./PlayerList\";\nimport { Tokens } from \"./Tokens\";\nimport { UserPlayerInventory } from \"./UserPlayerInventory\";\n\nconst useStyles = makeStyles(() =>\n  createStyles({\n    container: {\n      color: \"#000\",\n      backgroundColor: \"#fff\",\n      fontFamily: \"'Segoe UI', Tahoma, Geneva, Verdana, sans-serif\",\n      fontSize: \"calc(100vw/75)\",\n      height: \"100vh\",\n      display: \"grid\",\n      gridColumnGap: \"0.4rem\",\n      gridRowGap: \"0.4rem\",\n      gridTemplateColumns: \"auto 3rem calc(25% - 0.4rem)\",\n      gridTemplateRows: \"calc(75% - 0.4rem) 25%\",\n      gridTemplateAreas: `\n        \"board      tokens    player-list\"\n        \"inventory  inventory inventory\"`\n    },\n\n    tokens: {\n      gridArea: \"tokens\",\n      display: \"flex\",\n      flexDirection: \"column\",\n      alignItems: \"center\",\n      justifyContent: \"space-around\",\n      fontSize: \"1.9rem\",\n\n      \"& [itemProp='token'] [itemProp='count']\": {\n        fontWeight: 900\n      }\n    },\n\n    board: {\n      gridArea: \"board\",\n      display: \"flex\",\n      flexDirection: \"column\",\n      justifyContent: \"space-evenly\"\n    },\n\n    playerList: {\n      display: \"flex\",\n      flexDirection: \"column\",\n      alignContent: \"center\",\n      gridArea: \"player-list\",\n      backgroundColor: \"#fff\",\n      padding: \"0.4em\"\n    },\n\n    inventory: {\n      gridArea: \"inventory\",\n      display: \"flex\"\n    }\n  })\n);\n\nexport const Board = (props: Partial<IBoardProps<Model.GameState, Moves>>) => {\n  const {\n    G: { availableCards, availableTokens, currentPlayerId, players },\n    ctx: { gameover },\n    playerID,\n    moves,\n    step\n  } = props;\n\n  const [errorMessage, setErrorMessage] = useState(null);\n  const [selectedTokens, setSelectedTokens] = useState([]);\n\n  const userPlayerId = playerID || players[0].id;\n\n  const currentPlayer = useMemo(() => findPlayer(players, currentPlayerId), [\n    currentPlayerId,\n    players\n  ]);\n\n  const userPlayer = useMemo(() => findPlayer(players, userPlayerId), [\n    players,\n    userPlayerId\n  ]);\n\n  const otherPlayers = useMemo(\n    () => players.filter(x => x.id !== userPlayerId),\n    [players, userPlayerId]\n  );\n\n  const isUserPlayersTurn = userPlayerId === currentPlayerId;\n\n  useEffect(\n    function onCurrentPlayerChanged() {\n      setSelectedTokens([]);\n\n      if (!isUserPlayersTurn && currentPlayer && !currentPlayer.isHuman) {\n        // take the AI player's turn\n        step();\n        return;\n      }\n    },\n    [step, currentPlayer, isUserPlayersTurn]\n  );\n\n  const selectToken = useCallback(\n    token => {\n      if (token === Model.ResourceType.Wild) {\n        console.debug(`Ignoring invalid selection of a wild token`);\n        return;\n      }\n\n      let newSelectedTokens = selectedTokens;\n\n      if (selectedTokens.indexOf(token) > -1) {\n        if (selectedTokens.length === 1) {\n          moves.collectSingleResource(token);\n          newSelectedTokens = [];\n        } else {\n          console.debug(`Ignoring invalid duplicate selection of ${token}`);\n        }\n      } else {\n        newSelectedTokens = [...selectedTokens, token];\n      }\n\n      if (newSelectedTokens.length === 3) {\n        moves.collectMultipleResources(newSelectedTokens);\n        newSelectedTokens = [];\n      }\n\n      setSelectedTokens(newSelectedTokens);\n    },\n    [moves, selectedTokens]\n  );\n\n  const selectDevelopmentCard = useCallback(\n    (card: Model.DevelopmentCard): void => {\n      const playerResources = calculatePlayerResourceTotals(currentPlayer);\n\n      if (hasRequiredResources(card.cost, playerResources)) {\n        moves.purchaseDevelopmentCard(card);\n      } else {\n        moves.reserveDevelopmentCard(card);\n      }\n    },\n    [currentPlayer, moves]\n  );\n\n  const playReservedCard = useCallback(\n    (card: Model.DevelopmentCard): void => {\n      const playerResources = calculatePlayerResourceTotals(currentPlayer);\n\n      if (hasRequiredResources(card.cost, playerResources)) {\n        moves.purchaseDevelopmentCard(card);\n      } else {\n        showWarning(\"Not enough resources to purchase this card!\");\n      }\n    },\n    [currentPlayer, moves]\n  );\n\n  const showWarning = (message: string) => {\n    setErrorMessage(message);\n  };\n\n  return (\n    <>\n      {gameover && (\n        <GameOver\n          onClose={() => window.location.reload()}\n          results={gameover}\n          userPlayer={userPlayer}\n        />\n      )}\n      <MessageDialog message={errorMessage} />\n      <Overlay isActive={!isUserPlayersTurn} />\n      <BoardLayout\n        availableCards={availableCards}\n        availableTokens={availableTokens}\n        currentPlayer={currentPlayer}\n        otherPlayers={otherPlayers}\n        playReservedCard={playReservedCard}\n        selectDevelopmentCard={selectDevelopmentCard}\n        selectToken={selectToken}\n        userPlayer={userPlayer}\n      />\n    </>\n  );\n};\n\nconst MessageDialog = ({ message }) => {\n  const [isOpen, setIsOpen] = useState(false);\n\n  useEffect(() => setIsOpen(message && message.length > 0), [message]);\n\n  return (\n    <Snackbar\n      anchorOrigin={{ vertical: \"bottom\", horizontal: \"center\" }}\n      open={isOpen}\n      onClose={() => setIsOpen(false)}\n      autoHideDuration={2000}\n      message={message}\n    />\n  );\n};\n\ninterface BoardLayoutProps {\n  availableCards;\n  availableTokens;\n  currentPlayer;\n  otherPlayers;\n  userPlayer;\n  playReservedCard;\n  selectDevelopmentCard;\n  selectToken;\n}\n\nconst BoardLayout = ({\n  availableCards,\n  availableTokens,\n  currentPlayer,\n  otherPlayers,\n  playReservedCard,\n  selectDevelopmentCard,\n  selectToken,\n  userPlayer\n}: BoardLayoutProps) => {\n  const classes = useStyles({});\n\n  return (\n    <div id=\"container\" className={classes.container}>\n      <div id=\"tokens\" className={classes.tokens}>\n        <Tokens tokens={availableTokens} selectToken={selectToken} />\n      </div>\n      <div id=\"board\" className={classes.board}>\n        <CommunityCards\n          availableCards={availableCards}\n          selectDevelopmentCard={selectDevelopmentCard}\n        />\n      </div>\n      <div id=\"player-list\" className={classes.playerList}>\n        <PlayerList players={otherPlayers} currentPlayer={currentPlayer} />\n      </div>\n      <div id=\"inventory\" className={classes.inventory}>\n        {userPlayer && (\n          <UserPlayerInventory\n            isCurrentPlayer={userPlayer.id === currentPlayer.id}\n            player={userPlayer}\n            onPlayReservedCard={playReservedCard}\n          />\n        )}\n      </div>\n    </div>\n  );\n};\n","import { GameResults } from \"../../Model\";\nimport moves from \"./moves\";\nimport { initializeGame as setup } from \"./initializeGame\";\nimport { populateVisibleCards } from \"../../util\";\n\nexport type Moves = { [key in keyof typeof moves]: (...args) => void };\n\nexport const SplendidGame = {\n  setup,\n\n  moves,\n\n  turn: {\n    moveLimit: 1,\n    onBegin: (G, ctx) => {\n      G.currentPlayerId = ctx.currentPlayer;\n    },\n    onEnd: (G, ctx) => {\n      // TODO: evaluate patrons\n      populateVisibleCards(G.availableCards);\n    }\n  },\n  endIf: (G): GameResults | void => {\n    const winners = G.players.filter(x => x.prestigePoints >= 15);\n\n    if (winners.length) {\n      const rankings = [...G.players].sort(\n        (a, b) => b.prestigePoints - a.prestigePoints\n      );\n      return { winner: winners[0], rankings };\n    }\n  }\n};\n","import { importDeck, shuffle, populateVisibleCards } from \"../../util\";\nimport { Player } from \"Model\";\n\nexport const initializeGame = initial => {\n  const players: Player[] = Array(initial.numPlayers)\n    .fill(0)\n    .map(\n      (_, id) =>\n        ({\n          id: String(id),\n          name: `Player ${id + 1}`,\n          isHuman: false,\n          patrons: [],\n          playedCards: [],\n          tokens: {},\n          prestigePoints: 0,\n          reservedCards: [],\n          totalResources: {}\n        } as Player)\n    );\n\n  const deck = importDeck();\n\n  shuffle(deck);\n\n  const availableCards = [\n    {\n      level: 3,\n      stock: deck.filter(x => x.level === 3),\n      visibleCards: Array(4).fill(null)\n    },\n    {\n      level: 2,\n      stock: deck.filter(x => x.level === 2),\n      visibleCards: Array(4).fill(null)\n    },\n    {\n      level: 1,\n      stock: deck.filter(x => x.level === 1),\n      visibleCards: Array(4).fill(null)\n    }\n  ];\n\n  if (process.env.NODE_ENV !== \"production\") {\n    players[0].tokens.Wild = 1;\n    players[0].tokens.Diamond = 2;\n    new Array(4).fill(0).forEach(() => {\n      players[0].reservedCards.push(availableCards[2].stock.pop());\n    });\n    new Array(4).fill(0).forEach(() => {\n      players[0].playedCards.push(availableCards[2].stock.pop());\n    });\n\n    players[1].tokens.Wild = 3;\n    players[1].tokens.Sapphire = 3;\n    players[1].tokens.Ruby = 2;\n    new Array(4).fill(0).forEach(() => {\n      players[1].reservedCards.push(availableCards[2].stock.pop());\n    });\n    new Array(4).fill(0).forEach(() => {\n      players[1].playedCards.push(availableCards[2].stock.pop());\n    });\n  }\n\n  populateVisibleCards(availableCards);\n\n  const availableTokens = {\n    Wild: 7,\n    Emerald: 5,\n    Onyx: 5,\n    Ruby: 5,\n    Sapphire: 5,\n    Diamond: 5\n  };\n\n  return {\n    availableCards,\n    availableTokens,\n    players\n  };\n};\n","import { Client } from \"boardgame.io/react\";\nimport { observer } from \"mobx-react-lite\";\nimport React from \"react\";\nimport ai from \"./ai\";\nimport board from \"./board\";\nimport game from \"./game\";\nimport { GameSettings } from \"./setup/GameSettingsStore\";\n\nconst GameClient = observer<{ settings: GameSettings }>(({ settings }) => {\n  const View = Client({\n    game,\n    board,\n    ai,\n    numPlayers: settings.numberOfPlayers,\n    multiplayer: settings.multiplayer,\n    debug: process.env.NODE_ENV !== \"production\"\n  } as any);\n\n  return <View />;\n});\n\nexport default GameClient;\n","import React from \"react\";\nimport GameClient from \"./GameClient\";\nimport { observer } from \"mobx-react-lite\";\n\nconst SplendidGame = observer(() => {\n  return (\n    <GameClient\n      settings={{\n        debug: process.env.NODE_ENV !== \"production\",\n        numberOfPlayers: 4,\n        musicVolume: 0,\n        sfxVolume: 0,\n        players: []\n      }}\n    />\n  );\n});\nSplendidGame.displayName = \"SplendidGame\";\n\nexport default SplendidGame;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\ntype Config = {\n  onSuccess?: (registration: ServiceWorkerRegistration) => void;\n  onUpdate?: (registration: ServiceWorkerRegistration) => void;\n};\n\nexport function register(config?: Config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(\n      (process as { env: { [key: string]: string } }).env.PUBLIC_URL,\n      window.location.href\n    );\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl: string, config?: Config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl: string, config?: Config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from \"react\";\nimport ReactDOM from \"react-dom\";\nimport \"./index.css\";\nimport App from \"./App\";\nimport * as serviceWorker from \"./serviceWorker\";\n\nReactDOM.render(<App />, document.getElementById(\"root\"));\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.register();\n","import React from \"react\";\nimport Splendid from \"./Splendid\";\n\nexport default () => <Splendid />;\n"],"sourceRoot":""}